[0m16:54:34.162539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F332911160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F333C83ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F333C83B10>]}


============================== 16:54:34.167503 | 0e1c64c3-ff69-4e1e-b7b1-cf3e15ec380e ==============================
[0m16:54:34.167503 [info ] [MainThread]: Running with dbt=1.11.4
[0m16:54:34.168335 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt debug', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\musta\\ecommerce_pipeline\\logs'}
[0m16:54:34.191890 [info ] [MainThread]: dbt version: 1.11.4
[0m16:54:34.192493 [info ] [MainThread]: python version: 3.13.3
[0m16:54:34.192954 [info ] [MainThread]: python path: C:\Users\musta\AppData\Local\Programs\Python\Python313\python.exe
[0m16:54:34.193402 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m16:54:50.449399 [info ] [MainThread]: Using profiles dir at C:\Users\musta\.dbt
[0m16:54:50.450033 [info ] [MainThread]: Using profiles.yml file at C:\Users\musta\.dbt\profiles.yml
[0m16:54:50.450554 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\musta\ecommerce_pipeline\dbt_project.yml
[0m16:54:50.451054 [info ] [MainThread]: adapter type: bigquery
[0m16:54:50.451510 [info ] [MainThread]: adapter version: 1.11.0
[0m16:54:50.591633 [info ] [MainThread]: Configuration:
[0m16:54:50.592528 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:54:50.593392 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:54:50.594586 [info ] [MainThread]: Required dependencies:
[0m16:54:50.595388 [debug] [MainThread]: Executing "git --help"
[0m16:54:50.601033 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m16:54:50.602111 [info ] [MainThread]: Connection:
[0m16:54:50.603264 [info ] [MainThread]:   method: oauth
[0m16:54:50.604009 [info ] [MainThread]:   database: portfolio-ecommerce-pipeline
[0m16:54:50.604675 [info ] [MainThread]:   execution_project: portfolio-ecommerce-pipeline
[0m16:54:50.605288 [info ] [MainThread]:   schema: dbt_mos
[0m16:54:50.605877 [info ] [MainThread]:   location: US
[0m16:54:50.606529 [info ] [MainThread]:   priority: interactive
[0m16:54:50.607274 [info ] [MainThread]:   maximum_bytes_billed: None
[0m16:54:50.608004 [info ] [MainThread]:   impersonate_service_account: None
[0m16:54:50.608851 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m16:54:50.609829 [info ] [MainThread]:   job_retries: 1
[0m16:54:50.611705 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m16:54:50.612775 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m16:54:50.613519 [info ] [MainThread]:   timeout_seconds: 300
[0m16:54:50.614103 [info ] [MainThread]:   client_id: None
[0m16:54:50.614735 [info ] [MainThread]:   token_uri: None
[0m16:54:50.615338 [info ] [MainThread]:   compute_region: None
[0m16:54:50.616140 [info ] [MainThread]:   dataproc_cluster_name: None
[0m16:54:50.616805 [info ] [MainThread]:   gcs_bucket: None
[0m16:54:50.617385 [info ] [MainThread]:   dataproc_batch: None
[0m16:54:50.618709 [info ] [MainThread]: Registered adapter: bigquery=1.11.0
[0m16:54:51.282917 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m16:54:51.283683 [debug] [MainThread]: On debug: select 1 as id
[0m16:54:51.284394 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:54:54.240462 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery " "client: 'Runtime Error
  Failed to authenticate with supplied credentials
  error:
  Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.'
[0m16:54:54.240839 [debug] [MainThread]: BigQuery adapter: Unhandled error while running:
select 1 as id
[0m16:54:54.241113 [debug] [MainThread]: BigQuery adapter: Database Error
  Runtime Error
    Failed to authenticate with supplied credentials
    error:
    Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.
[0m16:54:54.241385 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m16:54:54.242008 [info ] [MainThread]: [31m2 checks failed:[0m
[0m16:54:54.242552 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH and that the user has permissions to run it: "git"

[0m16:54:54.243141 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >'NoneType' object has no attribute 'close'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m16:54:54.244701 [debug] [MainThread]: Command `dbt debug` failed at 16:54:54.244560 after 20.22 seconds
[0m16:54:54.245103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F343EB1940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F350CC4710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F350B19150>]}
[0m16:54:54.245499 [debug] [MainThread]: Flushing usage events
[0m16:54:55.395283 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:54:09.719933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001333E5C1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001333F947ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001333F947B10>]}


============================== 00:54:09.725828 | 1a14fa9a-8339-40a8-bf5f-127d7ef63742 ==============================
[0m00:54:09.725828 [info ] [MainThread]: Running with dbt=1.11.4
[0m00:54:09.726633 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\musta\\ecommerce_pipeline\\logs'}
[0m00:54:33.755939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a14fa9a-8339-40a8-bf5f-127d7ef63742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001333EC41810>]}
[0m00:54:33.886548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a14fa9a-8339-40a8-bf5f-127d7ef63742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001335CA0DAE0>]}
[0m00:54:33.887442 [info ] [MainThread]: Registered adapter: bigquery=1.11.0
[0m00:54:35.249858 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m00:54:35.251844 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:54:35.252748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1a14fa9a-8339-40a8-bf5f-127d7ef63742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001335C9DEB50>]}
[0m00:54:38.785730 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_pipeline.example
[0m00:54:38.791874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a14fa9a-8339-40a8-bf5f-127d7ef63742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013355D17200>]}
[0m00:54:38.868782 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\ecommerce_pipeline\target\manifest.json
[0m00:54:38.872328 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\ecommerce_pipeline\target\semantic_manifest.json
[0m00:54:38.904035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a14fa9a-8339-40a8-bf5f-127d7ef63742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001335D35CD70>]}
[0m00:54:38.904594 [info ] [MainThread]: Found 4 models, 538 macros
[0m00:54:38.905138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a14fa9a-8339-40a8-bf5f-127d7ef63742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001335D28CE20>]}
[0m00:54:38.907852 [info ] [MainThread]: 
[0m00:54:38.908422 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:54:38.908847 [info ] [MainThread]: 
[0m00:54:38.909559 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:54:38.914915 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_portfolio-ecommerce-pipeline'
[0m00:54:38.915570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:54:40.402600 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_portfolio-ecommerce-pipeline, now create_portfolio-ecommerce-pipeline_dbt_mos)
[0m00:54:40.403512 [debug] [ThreadPool]: Creating schema "database: "portfolio-ecommerce-pipeline"
schema: "dbt_mos"
"
[0m00:54:40.414849 [debug] [ThreadPool]: On create_portfolio-ecommerce-pipeline_dbt_mos: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "create_portfolio-ecommerce-pipeline_dbt_mos"} */
create schema if not exists `portfolio-ecommerce-pipeline`.`dbt_mos`
  
[0m00:54:40.415252 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:54:42.192132 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:1fd48fe8-f58e-4acb-b45b-32795585b0de&page=queryresults
[0m00:54:42.931791 [debug] [ThreadPool]: SQL status: OK in 0.739 seconds
[0m00:54:44.043089 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_portfolio-ecommerce-pipeline_dbt_mos'
[0m00:54:44.043520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:54:45.305647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a14fa9a-8339-40a8-bf5f-127d7ef63742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001335D3A7D10>]}
[0m00:54:45.306080 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:54:45.347693 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.stg_orders
[0m00:54:45.348384 [info ] [Thread-1 (]: 1 of 4 START sql view model dbt_mos.stg_orders ................................. [RUN]
[0m00:54:45.349300 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ecommerce_pipeline.stg_orders'
[0m00:54:45.349720 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.stg_orders
[0m00:54:45.356369 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.stg_orders"
[0m00:54:45.358933 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.stg_orders
[0m00:54:45.396666 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.stg_orders"
[0m00:54:45.399475 [debug] [Thread-1 (]: On model.ecommerce_pipeline.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.stg_orders"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_orders`
  OPTIONS()
  as with source as (
    select * from `bigquery-public-data.thelook_ecommerce.orders`
)

select
    order_id,
    user_id,
    status,
    created_at as order_date,
    num_of_item as item_count
from source;


[0m00:54:45.400039 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:54:47.329806 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:5c178d22-e720-498e-9154-0325e77ca55a&page=queryresults
[0m00:54:47.897983 [debug] [Thread-1 (]: SQL status: OK in 0.568 seconds
[0m00:54:47.916560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a14fa9a-8339-40a8-bf5f-127d7ef63742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001335D61E200>]}
[0m00:54:47.917232 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dbt_mos.stg_orders ............................ [[32mCREATE VIEW (0 processed)[0m in 2.57s]
[0m00:54:47.918249 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.stg_orders
[0m00:54:47.918596 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.stg_users
[0m00:54:47.919108 [info ] [Thread-1 (]: 2 of 4 START sql view model dbt_mos.stg_users .................................. [RUN]
[0m00:54:47.919901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.stg_orders, now model.ecommerce_pipeline.stg_users)
[0m00:54:47.920219 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.stg_users
[0m00:54:47.921769 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.stg_users"
[0m00:54:47.924008 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.stg_users
[0m00:54:47.927866 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.stg_users"
[0m00:54:47.929269 [debug] [Thread-1 (]: On model.ecommerce_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.stg_users"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_users`
  OPTIONS()
  as with source as (
    select * from `bigquery-public-data.thelook_ecommerce.users`
)

select
    id as user_id,
    first_name,
    last_name,
    email,
    country,
    created_at as signup_date
from source;


[0m00:54:47.929863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:49.496183 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:c775f268-b1eb-4016-a665-932e1e54654c&page=queryresults
[0m00:54:49.975369 [debug] [Thread-1 (]: SQL status: OK in 0.479 seconds
[0m00:54:49.980332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a14fa9a-8339-40a8-bf5f-127d7ef63742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001335DCE47D0>]}
[0m00:54:49.981210 [info ] [Thread-1 (]: 2 of 4 OK created sql view model dbt_mos.stg_users ............................. [[32mCREATE VIEW (0 processed)[0m in 2.06s]
[0m00:54:49.982228 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.stg_users
[0m00:54:49.982997 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.int_orders_with_users
[0m00:54:49.983612 [info ] [Thread-1 (]: 3 of 4 START sql view model dbt_mos.int_orders_with_users ...................... [RUN]
[0m00:54:49.984323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.stg_users, now model.ecommerce_pipeline.int_orders_with_users)
[0m00:54:49.984793 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.int_orders_with_users
[0m00:54:49.988309 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.int_orders_with_users"
[0m00:54:49.989553 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.int_orders_with_users
[0m00:54:49.992767 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.int_orders_with_users"
[0m00:54:49.994490 [debug] [Thread-1 (]: On model.ecommerce_pipeline.int_orders_with_users: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.int_orders_with_users"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`int_orders_with_users`
  OPTIONS()
  as with orders as (
    select * from `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_orders`
),

users as (
    select * from `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_users`
)

select
    o.order_id,
    o.order_date,
    o.status,
    o.item_count,
    u.user_id,
    u.first_name,
    u.last_name,
    u.country
from orders o
left join users u on o.user_id = u.user_id;


[0m00:54:49.995104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:51.670791 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:ff1801dc-db1c-4f49-be5e-6178c7f5a23d&page=queryresults
[0m00:54:52.736854 [debug] [Thread-1 (]: SQL status: OK in 1.066 seconds
[0m00:54:52.741312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a14fa9a-8339-40a8-bf5f-127d7ef63742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001335DBFA150>]}
[0m00:54:52.742126 [info ] [Thread-1 (]: 3 of 4 OK created sql view model dbt_mos.int_orders_with_users ................. [[32mCREATE VIEW (0 processed)[0m in 2.76s]
[0m00:54:52.743317 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.int_orders_with_users
[0m00:54:52.744148 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.fct_daily_sales
[0m00:54:52.744718 [info ] [Thread-1 (]: 4 of 4 START sql view model dbt_mos.fct_daily_sales ............................ [RUN]
[0m00:54:52.745436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.int_orders_with_users, now model.ecommerce_pipeline.fct_daily_sales)
[0m00:54:52.745969 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.fct_daily_sales
[0m00:54:52.748798 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.fct_daily_sales"
[0m00:54:52.750121 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.fct_daily_sales
[0m00:54:52.753300 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.fct_daily_sales"
[0m00:54:52.755019 [debug] [Thread-1 (]: On model.ecommerce_pipeline.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.fct_daily_sales"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`fct_daily_sales`
  OPTIONS()
  as with orders as (
    select * from `portfolio-ecommerce-pipeline`.`dbt_mos`.`int_orders_with_users`
)

select
    date(order_date) as sale_date,
    country,
    count(distinct order_id) as total_orders,
    count(distinct user_id) as unique_customers,
    sum(item_count) as total_items_sold
from orders
where status = 'Complete'
group by 1, 2;


[0m00:54:52.755543 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:54:54.665028 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:bb2cd186-d15d-4daa-a082-180693c92faa&page=queryresults
[0m00:54:55.127760 [debug] [Thread-1 (]: SQL status: OK in 0.462 seconds
[0m00:54:55.131324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a14fa9a-8339-40a8-bf5f-127d7ef63742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001335D5A07C0>]}
[0m00:54:55.131840 [info ] [Thread-1 (]: 4 of 4 OK created sql view model dbt_mos.fct_daily_sales ....................... [[32mCREATE VIEW (0 processed)[0m in 2.39s]
[0m00:54:55.133039 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.fct_daily_sales
[0m00:54:55.134616 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:54:55.176133 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:54:55.176606 [debug] [MainThread]: Connection 'create_portfolio-ecommerce-pipeline_dbt_mos' was properly closed.
[0m00:54:55.176986 [debug] [MainThread]: Connection 'list_portfolio-ecommerce-pipeline_dbt_mos' was properly closed.
[0m00:54:55.177269 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.fct_daily_sales' was properly closed.
[0m00:54:55.177859 [info ] [MainThread]: 
[0m00:54:55.178507 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 16.27 seconds (16.27s).
[0m00:54:55.180229 [debug] [MainThread]: Command end result
[0m00:54:55.207880 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\ecommerce_pipeline\target\manifest.json
[0m00:54:55.210421 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\ecommerce_pipeline\target\semantic_manifest.json
[0m00:54:55.218510 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\musta\ecommerce_pipeline\target\run_results.json
[0m00:54:55.218975 [info ] [MainThread]: 
[0m00:54:55.219849 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:54:55.220744 [info ] [MainThread]: 
[0m00:54:55.221705 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m00:54:55.222873 [debug] [MainThread]: Command `dbt run` succeeded at 00:54:55.222737 after 45.69 seconds
[0m00:54:55.223308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001335D553AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001335DD2BCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001335DD2BB90>]}
[0m00:54:55.223962 [debug] [MainThread]: Flushing usage events
[0m00:54:56.342669 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:57:38.551449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267558F1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026756C67ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026756C67B10>]}


============================== 00:57:38.558074 | df335c03-a482-440a-871f-b275e49a3b00 ==============================
[0m00:57:38.558074 [info ] [MainThread]: Running with dbt=1.11.4
[0m00:57:38.559197 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'use_colors': 'True', 'invocation_command': 'dbt test', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\musta\\ecommerce_pipeline\\logs'}
[0m00:58:03.580312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df335c03-a482-440a-871f-b275e49a3b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026755F61810>]}
[0m00:58:03.678111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df335c03-a482-440a-871f-b275e49a3b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026773D09AE0>]}
[0m00:58:03.678843 [info ] [MainThread]: Registered adapter: bigquery=1.11.0
[0m00:58:04.400326 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m00:58:04.576257 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:58:04.577191 [debug] [MainThread]: Partial parsing: added file: ecommerce_pipeline://models\staging\schema.yml
[0m00:58:04.958074 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_pipeline.example
[0m00:58:04.967771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df335c03-a482-440a-871f-b275e49a3b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026773CCAF50>]}
[0m00:58:05.087223 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\ecommerce_pipeline\target\manifest.json
[0m00:58:05.092347 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\ecommerce_pipeline\target\semantic_manifest.json
[0m00:58:05.142802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df335c03-a482-440a-871f-b275e49a3b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026774968050>]}
[0m00:58:05.143457 [info ] [MainThread]: Found 4 models, 4 data tests, 538 macros
[0m00:58:05.144061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df335c03-a482-440a-871f-b275e49a3b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267749790F0>]}
[0m00:58:05.147049 [info ] [MainThread]: 
[0m00:58:05.147724 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:58:05.148270 [info ] [MainThread]: 
[0m00:58:05.149328 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:58:05.157917 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_portfolio-ecommerce-pipeline_dbt_mos'
[0m00:58:05.158490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:58:06.685721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df335c03-a482-440a-871f-b275e49a3b00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026774971160>]}
[0m00:58:06.686500 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:58:06.739759 [debug] [Thread-1 (]: Began running node test.ecommerce_pipeline.not_null_stg_orders_order_id.81cfe2fe64
[0m00:58:06.740392 [info ] [Thread-1 (]: 1 of 4 START test not_null_stg_orders_order_id ................................. [RUN]
[0m00:58:06.741252 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.ecommerce_pipeline.not_null_stg_orders_order_id.81cfe2fe64'
[0m00:58:06.741712 [debug] [Thread-1 (]: Began compiling node test.ecommerce_pipeline.not_null_stg_orders_order_id.81cfe2fe64
[0m00:58:06.760670 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_pipeline.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:58:06.762563 [debug] [Thread-1 (]: Began executing node test.ecommerce_pipeline.not_null_stg_orders_order_id.81cfe2fe64
[0m00:58:06.793282 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_pipeline.not_null_stg_orders_order_id.81cfe2fe64"
[0m00:58:06.797071 [debug] [Thread-1 (]: On test.ecommerce_pipeline.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "test.ecommerce_pipeline.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_orders`
where order_id is null



  
  
      
    ) dbt_internal_test
[0m00:58:06.797974 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:58:08.630875 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:5438415e-5da6-4435-a620-59e2a81f2421&page=queryresults
[0m00:58:08.934441 [debug] [Thread-1 (]: SQL status: OK in 0.303 seconds
[0m00:58:09.564796 [info ] [Thread-1 (]: 1 of 4 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 2.82s]
[0m00:58:09.566221 [debug] [Thread-1 (]: Finished running node test.ecommerce_pipeline.not_null_stg_orders_order_id.81cfe2fe64
[0m00:58:09.566730 [debug] [Thread-1 (]: Began running node test.ecommerce_pipeline.not_null_stg_users_user_id.980dfc1b77
[0m00:58:09.567213 [info ] [Thread-1 (]: 2 of 4 START test not_null_stg_users_user_id ................................... [RUN]
[0m00:58:09.567923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_pipeline.not_null_stg_orders_order_id.81cfe2fe64, now test.ecommerce_pipeline.not_null_stg_users_user_id.980dfc1b77)
[0m00:58:09.568233 [debug] [Thread-1 (]: Began compiling node test.ecommerce_pipeline.not_null_stg_users_user_id.980dfc1b77
[0m00:58:09.571763 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_pipeline.not_null_stg_users_user_id.980dfc1b77"
[0m00:58:09.572896 [debug] [Thread-1 (]: Began executing node test.ecommerce_pipeline.not_null_stg_users_user_id.980dfc1b77
[0m00:58:09.575279 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_pipeline.not_null_stg_users_user_id.980dfc1b77"
[0m00:58:09.576317 [debug] [Thread-1 (]: On test.ecommerce_pipeline.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "test.ecommerce_pipeline.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_users`
where user_id is null



  
  
      
    ) dbt_internal_test
[0m00:58:09.576853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:58:11.459765 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:fd6d9dba-1070-4385-8e5d-2de0f57f9c59&page=queryresults
[0m00:58:11.741980 [debug] [Thread-1 (]: SQL status: OK in 0.282 seconds
[0m00:58:12.333581 [info ] [Thread-1 (]: 2 of 4 PASS not_null_stg_users_user_id ......................................... [[32mPASS[0m in 2.77s]
[0m00:58:12.335108 [debug] [Thread-1 (]: Finished running node test.ecommerce_pipeline.not_null_stg_users_user_id.980dfc1b77
[0m00:58:12.335839 [debug] [Thread-1 (]: Began running node test.ecommerce_pipeline.unique_stg_orders_order_id.e3b841c71a
[0m00:58:12.336760 [info ] [Thread-1 (]: 3 of 4 START test unique_stg_orders_order_id ................................... [RUN]
[0m00:58:12.338289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_pipeline.not_null_stg_users_user_id.980dfc1b77, now test.ecommerce_pipeline.unique_stg_orders_order_id.e3b841c71a)
[0m00:58:12.338867 [debug] [Thread-1 (]: Began compiling node test.ecommerce_pipeline.unique_stg_orders_order_id.e3b841c71a
[0m00:58:12.347317 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_pipeline.unique_stg_orders_order_id.e3b841c71a"
[0m00:58:12.348754 [debug] [Thread-1 (]: Began executing node test.ecommerce_pipeline.unique_stg_orders_order_id.e3b841c71a
[0m00:58:12.351646 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_pipeline.unique_stg_orders_order_id.e3b841c71a"
[0m00:58:12.353205 [debug] [Thread-1 (]: On test.ecommerce_pipeline.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "test.ecommerce_pipeline.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:58:12.353982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:58:15.033969 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:9a10fc60-0f38-4866-b9b3-ddeba9e51f6a&page=queryresults
[0m00:58:15.384237 [debug] [Thread-1 (]: SQL status: OK in 0.349 seconds
[0m00:58:16.008501 [info ] [Thread-1 (]: 3 of 4 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 3.67s]
[0m00:58:16.009951 [debug] [Thread-1 (]: Finished running node test.ecommerce_pipeline.unique_stg_orders_order_id.e3b841c71a
[0m00:58:16.010694 [debug] [Thread-1 (]: Began running node test.ecommerce_pipeline.unique_stg_users_user_id.c2ff477e6b
[0m00:58:16.011425 [info ] [Thread-1 (]: 4 of 4 START test unique_stg_users_user_id ..................................... [RUN]
[0m00:58:16.012905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_pipeline.unique_stg_orders_order_id.e3b841c71a, now test.ecommerce_pipeline.unique_stg_users_user_id.c2ff477e6b)
[0m00:58:16.014059 [debug] [Thread-1 (]: Began compiling node test.ecommerce_pipeline.unique_stg_users_user_id.c2ff477e6b
[0m00:58:16.019858 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_pipeline.unique_stg_users_user_id.c2ff477e6b"
[0m00:58:16.022335 [debug] [Thread-1 (]: Began executing node test.ecommerce_pipeline.unique_stg_users_user_id.c2ff477e6b
[0m00:58:16.025960 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_pipeline.unique_stg_users_user_id.c2ff477e6b"
[0m00:58:16.027978 [debug] [Thread-1 (]: On test.ecommerce_pipeline.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "test.ecommerce_pipeline.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select user_id as unique_field
  from `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_users`
  where user_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m00:58:16.029010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:58:18.090002 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:12d98e82-ae5e-4779-8e91-36316ad352c5&page=queryresults
[0m00:58:18.386334 [debug] [Thread-1 (]: SQL status: OK in 0.296 seconds
[0m00:58:18.925362 [info ] [Thread-1 (]: 4 of 4 PASS unique_stg_users_user_id ........................................... [[32mPASS[0m in 2.91s]
[0m00:58:18.927150 [debug] [Thread-1 (]: Finished running node test.ecommerce_pipeline.unique_stg_users_user_id.c2ff477e6b
[0m00:58:18.928947 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:58:18.995299 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:58:18.995986 [debug] [MainThread]: Connection 'list_portfolio-ecommerce-pipeline_dbt_mos' was properly closed.
[0m00:58:18.996703 [debug] [MainThread]: Connection 'test.ecommerce_pipeline.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m00:58:18.997566 [info ] [MainThread]: 
[0m00:58:18.998708 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 13.85 seconds (13.85s).
[0m00:58:19.001550 [debug] [MainThread]: Command end result
[0m00:58:19.041703 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\ecommerce_pipeline\target\manifest.json
[0m00:58:19.045893 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\ecommerce_pipeline\target\semantic_manifest.json
[0m00:58:19.059983 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\musta\ecommerce_pipeline\target\run_results.json
[0m00:58:19.060725 [info ] [MainThread]: 
[0m00:58:19.061625 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:58:19.062293 [info ] [MainThread]: 
[0m00:58:19.063023 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m00:58:19.064321 [debug] [MainThread]: Command `dbt test` succeeded at 00:58:19.064091 after 40.82 seconds
[0m00:58:19.064867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026756A46C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002677472BD80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002677472A410>]}
[0m00:58:19.065327 [debug] [MainThread]: Flushing usage events
[0m00:58:20.238230 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:02:47.182676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E31B3D1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E31C747ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E31C747B10>]}


============================== 01:02:47.187909 | c94b4c11-3bc4-4dd3-b906-a93281eabbe2 ==============================
[0m01:02:47.187909 [info ] [MainThread]: Running with dbt=1.11.4
[0m01:02:47.188727 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt docs generate', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\musta\\ecommerce_pipeline\\logs'}
[0m01:03:06.268674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c94b4c11-3bc4-4dd3-b906-a93281eabbe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E31BA41810>]}
[0m01:03:06.354972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c94b4c11-3bc4-4dd3-b906-a93281eabbe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E33967DAE0>]}
[0m01:03:06.355618 [info ] [MainThread]: Registered adapter: bigquery=1.11.0
[0m01:03:07.257141 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m01:03:07.471949 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:03:07.472409 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m01:03:07.472764 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:03:07.480286 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_pipeline.example
[0m01:03:07.533905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c94b4c11-3bc4-4dd3-b906-a93281eabbe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E33A005950>]}
[0m01:03:07.587397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c94b4c11-3bc4-4dd3-b906-a93281eabbe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E33A0BDA90>]}
[0m01:03:07.588414 [info ] [MainThread]: Found 4 models, 4 data tests, 538 macros
[0m01:03:07.589270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c94b4c11-3bc4-4dd3-b906-a93281eabbe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E33A196430>]}
[0m01:03:07.592857 [info ] [MainThread]: 
[0m01:03:07.594653 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:03:07.596030 [info ] [MainThread]: 
[0m01:03:07.597271 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:03:07.604808 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_portfolio-ecommerce-pipeline_dbt_mos'
[0m01:03:07.605622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:03:10.723274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c94b4c11-3bc4-4dd3-b906-a93281eabbe2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E33A023AD0>]}
[0m01:03:10.724286 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:03:10.783486 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.stg_orders
[0m01:03:10.784186 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ecommerce_pipeline.stg_orders'
[0m01:03:10.784892 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.stg_orders
[0m01:03:10.796292 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.stg_orders"
[0m01:03:10.797514 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.stg_orders
[0m01:03:10.798418 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:03:10.858847 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.stg_orders
[0m01:03:10.859874 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.stg_users
[0m01:03:10.860929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.stg_orders, now model.ecommerce_pipeline.stg_users)
[0m01:03:10.861731 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.stg_users
[0m01:03:10.865284 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.stg_users"
[0m01:03:10.866863 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.stg_users
[0m01:03:10.867728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:10.927748 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.stg_users
[0m01:03:10.928283 [debug] [Thread-1 (]: Began running node test.ecommerce_pipeline.not_null_stg_orders_order_id.81cfe2fe64
[0m01:03:10.928949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.stg_users, now test.ecommerce_pipeline.not_null_stg_orders_order_id.81cfe2fe64)
[0m01:03:10.929584 [debug] [Thread-1 (]: Began compiling node test.ecommerce_pipeline.not_null_stg_orders_order_id.81cfe2fe64
[0m01:03:10.946167 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_pipeline.not_null_stg_orders_order_id.81cfe2fe64"
[0m01:03:10.947254 [debug] [Thread-1 (]: Began executing node test.ecommerce_pipeline.not_null_stg_orders_order_id.81cfe2fe64
[0m01:03:10.947762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:10.998041 [debug] [Thread-1 (]: Finished running node test.ecommerce_pipeline.not_null_stg_orders_order_id.81cfe2fe64
[0m01:03:10.998554 [debug] [Thread-1 (]: Began running node test.ecommerce_pipeline.unique_stg_orders_order_id.e3b841c71a
[0m01:03:10.999129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_pipeline.not_null_stg_orders_order_id.81cfe2fe64, now test.ecommerce_pipeline.unique_stg_orders_order_id.e3b841c71a)
[0m01:03:10.999584 [debug] [Thread-1 (]: Began compiling node test.ecommerce_pipeline.unique_stg_orders_order_id.e3b841c71a
[0m01:03:11.006936 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_pipeline.unique_stg_orders_order_id.e3b841c71a"
[0m01:03:11.007977 [debug] [Thread-1 (]: Began executing node test.ecommerce_pipeline.unique_stg_orders_order_id.e3b841c71a
[0m01:03:11.008485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:11.073502 [debug] [Thread-1 (]: Finished running node test.ecommerce_pipeline.unique_stg_orders_order_id.e3b841c71a
[0m01:03:11.074291 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.int_orders_with_users
[0m01:03:11.075153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_pipeline.unique_stg_orders_order_id.e3b841c71a, now model.ecommerce_pipeline.int_orders_with_users)
[0m01:03:11.075666 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.int_orders_with_users
[0m01:03:11.078847 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.int_orders_with_users"
[0m01:03:11.080068 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.int_orders_with_users
[0m01:03:11.080669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:11.144171 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.int_orders_with_users
[0m01:03:11.144785 [debug] [Thread-1 (]: Began running node test.ecommerce_pipeline.not_null_stg_users_user_id.980dfc1b77
[0m01:03:11.145444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.int_orders_with_users, now test.ecommerce_pipeline.not_null_stg_users_user_id.980dfc1b77)
[0m01:03:11.146029 [debug] [Thread-1 (]: Began compiling node test.ecommerce_pipeline.not_null_stg_users_user_id.980dfc1b77
[0m01:03:11.150589 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_pipeline.not_null_stg_users_user_id.980dfc1b77"
[0m01:03:11.151690 [debug] [Thread-1 (]: Began executing node test.ecommerce_pipeline.not_null_stg_users_user_id.980dfc1b77
[0m01:03:11.152185 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:11.202549 [debug] [Thread-1 (]: Finished running node test.ecommerce_pipeline.not_null_stg_users_user_id.980dfc1b77
[0m01:03:11.203647 [debug] [Thread-1 (]: Began running node test.ecommerce_pipeline.unique_stg_users_user_id.c2ff477e6b
[0m01:03:11.204392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_pipeline.not_null_stg_users_user_id.980dfc1b77, now test.ecommerce_pipeline.unique_stg_users_user_id.c2ff477e6b)
[0m01:03:11.205022 [debug] [Thread-1 (]: Began compiling node test.ecommerce_pipeline.unique_stg_users_user_id.c2ff477e6b
[0m01:03:11.214195 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_pipeline.unique_stg_users_user_id.c2ff477e6b"
[0m01:03:11.215797 [debug] [Thread-1 (]: Began executing node test.ecommerce_pipeline.unique_stg_users_user_id.c2ff477e6b
[0m01:03:11.216671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:11.282822 [debug] [Thread-1 (]: Finished running node test.ecommerce_pipeline.unique_stg_users_user_id.c2ff477e6b
[0m01:03:11.283577 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.fct_daily_sales
[0m01:03:11.284274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_pipeline.unique_stg_users_user_id.c2ff477e6b, now model.ecommerce_pipeline.fct_daily_sales)
[0m01:03:11.284755 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.fct_daily_sales
[0m01:03:11.287866 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.fct_daily_sales"
[0m01:03:11.288978 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.fct_daily_sales
[0m01:03:11.289517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:11.339044 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.fct_daily_sales
[0m01:03:11.340475 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:03:11.340958 [debug] [MainThread]: Connection 'list_portfolio-ecommerce-pipeline_dbt_mos' was properly closed.
[0m01:03:11.341335 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.fct_daily_sales' was properly closed.
[0m01:03:11.343612 [debug] [MainThread]: Command end result
[0m01:03:11.512748 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\ecommerce_pipeline\target\manifest.json
[0m01:03:11.516744 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\ecommerce_pipeline\target\semantic_manifest.json
[0m01:03:11.531352 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\musta\ecommerce_pipeline\target\run_results.json
[0m01:03:16.269008 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m01:03:16.269468 [info ] [MainThread]: Building catalog
[0m01:03:16.275060 [debug] [ThreadPool]: Acquiring new bigquery connection 'portfolio-ecommerce-pipeline.information_schema'
[0m01:03:16.295937 [debug] [ThreadPool]: On portfolio-ecommerce-pipeline.information_schema: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "portfolio-ecommerce-pipeline.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `portfolio-ecommerce-pipeline`.`dbt_mos`.__TABLES__ tables
    left join `portfolio-ecommerce-pipeline`.`dbt_mos`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `portfolio-ecommerce-pipeline`.`dbt_mos`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dbt_mos')
                            and upper(table_name) = upper('int_orders_with_users')
                            ) or (
                                upper(table_schema) = upper('dbt_mos')
                            and upper(table_name) = upper('stg_users')
                            ) or (
                                upper(table_schema) = upper('dbt_mos')
                            and upper(table_name) = upper('stg_orders')
                            ) or (
                                upper(table_schema) = upper('dbt_mos')
                            and upper(table_name) = upper('fct_daily_sales')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `portfolio-ecommerce-pipeline`.`dbt_mos`.INFORMATION_SCHEMA.COLUMNS columns
    join `portfolio-ecommerce-pipeline`.`dbt_mos`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m01:03:16.296723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:03:18.098333 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:16d0c58e-dc16-4a24-bbd7-d05fed6bee19&page=queryresults
[0m01:03:19.204328 [debug] [ThreadPool]: SQL status: OK in 1.106 seconds
[0m01:03:19.775868 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:03:19.823297 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\musta\ecommerce_pipeline\target\catalog.json
[0m01:03:19.844802 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\ecommerce_pipeline\target\manifest.json
[0m01:03:19.847403 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\ecommerce_pipeline\target\semantic_manifest.json
[0m01:03:19.847839 [info ] [MainThread]: Catalog written to C:\Users\musta\ecommerce_pipeline\target\catalog.json
[0m01:03:19.849135 [debug] [MainThread]: Command `dbt docs generate` succeeded at 01:03:19.849027 after 32.82 seconds
[0m01:03:19.849405 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m01:03:19.849669 [debug] [MainThread]: Connection 'portfolio-ecommerce-pipeline.information_schema' was properly closed.
[0m01:03:19.850075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E31C526C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E33A5D57B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E33A5D5650>]}
[0m01:03:19.850369 [debug] [MainThread]: Flushing usage events
[0m01:03:20.887611 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:05:10.620673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC0BEE1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC0D06FED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC0D06FB10>]}


============================== 01:05:10.625362 | 8b5c6ede-5e75-4822-801a-ac36ebd6faa0 ==============================
[0m01:05:10.625362 [info ] [MainThread]: Running with dbt=1.11.4
[0m01:05:10.626373 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt docs serve', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\musta\\ecommerce_pipeline\\logs'}
[0m01:05:25.179319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b5c6ede-5e75-4822-801a-ac36ebd6faa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC0C371810>]}
[0m01:05:25.248694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b5c6ede-5e75-4822-801a-ac36ebd6faa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1D1F9AE0>]}
[0m01:11:07.803513 [error] [MainThread]: Encountered an error:

[0m01:11:07.852616 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\musta\AppData\Local\Programs\Python\Python313\Lib\site-packages\dbt\cli\requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\musta\AppData\Local\Programs\Python\Python313\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\musta\AppData\Local\Programs\Python\Python313\Lib\site-packages\dbt\cli\requires.py", line 276, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\musta\AppData\Local\Programs\Python\Python313\Lib\site-packages\dbt\cli\requires.py", line 321, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\musta\AppData\Local\Programs\Python\Python313\Lib\site-packages\dbt\cli\requires.py", line 368, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\musta\AppData\Local\Programs\Python\Python313\Lib\site-packages\dbt\cli\main.py", line 307, in docs_serve
    results = task.run()
  File "C:\Users\musta\AppData\Local\Programs\Python\Python313\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
    ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\musta\AppData\Local\Programs\Python\Python313\Lib\socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
  File "C:\Users\musta\AppData\Local\Programs\Python\Python313\Lib\selectors.py", line 314, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\musta\AppData\Local\Programs\Python\Python313\Lib\selectors.py", line 305, in _select
    r, w, x = select.select(r, w, w, timeout)
              ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m01:11:07.855602 [debug] [MainThread]: Command `dbt docs serve` failed at 01:11:07.855396 after 357.36 seconds
[0m01:11:07.855960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1D321E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1D321D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1D344D70>]}
[0m01:11:07.856633 [debug] [MainThread]: Flushing usage events
[0m01:11:08.975442 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:11:13.748500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001645CE61160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001645E1DFED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001645E1DFB10>]}


============================== 01:11:13.753583 | 252a6516-18e1-451b-a1cf-66b2d9638532 ==============================
[0m01:11:13.753583 [info ] [MainThread]: Running with dbt=1.11.4
[0m01:11:13.754632 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'invocation_command': 'dbt run', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\musta\\ecommerce_pipeline\\logs'}
[0m01:11:36.729840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '252a6516-18e1-451b-a1cf-66b2d9638532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001645D4E1810>]}
[0m01:11:36.815367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '252a6516-18e1-451b-a1cf-66b2d9638532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001647B161AE0>]}
[0m01:11:36.816313 [info ] [MainThread]: Registered adapter: bigquery=1.11.0
[0m01:11:37.468327 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m01:11:37.711135 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 8 files added, 0 files changed.
[0m01:11:37.711819 [debug] [MainThread]: Partial parsing: added file: ecommerce_pipeline://models\intermediate\int_order_items_with_products.sql
[0m01:11:37.712429 [debug] [MainThread]: Partial parsing: added file: ecommerce_pipeline://models\marts\fct_monthly_revenue.sql
[0m01:11:37.713002 [debug] [MainThread]: Partial parsing: added file: ecommerce_pipeline://models\staging\stg_events.sql
[0m01:11:37.713440 [debug] [MainThread]: Partial parsing: added file: ecommerce_pipeline://models\marts\fct_product_performance.sql
[0m01:11:37.713893 [debug] [MainThread]: Partial parsing: added file: ecommerce_pipeline://models\intermediate\int_customer_orders.sql
[0m01:11:37.714310 [debug] [MainThread]: Partial parsing: added file: ecommerce_pipeline://models\marts\fct_customer_lifetime_value.sql
[0m01:11:37.714720 [debug] [MainThread]: Partial parsing: added file: ecommerce_pipeline://models\staging\stg_order_items.sql
[0m01:11:37.715160 [debug] [MainThread]: Partial parsing: added file: ecommerce_pipeline://models\staging\stg_products.sql
[0m01:11:38.079899 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_pipeline.example
[0m01:11:38.085830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '252a6516-18e1-451b-a1cf-66b2d9638532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001647BAAE450>]}
[0m01:11:38.174147 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\ecommerce_pipeline\target\manifest.json
[0m01:11:38.177235 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\ecommerce_pipeline\target\semantic_manifest.json
[0m01:11:38.209016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '252a6516-18e1-451b-a1cf-66b2d9638532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001647B0A7D40>]}
[0m01:11:38.209488 [info ] [MainThread]: Found 12 models, 4 data tests, 538 macros
[0m01:11:38.210238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '252a6516-18e1-451b-a1cf-66b2d9638532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001647BAB7930>]}
[0m01:11:38.212868 [info ] [MainThread]: 
[0m01:11:38.213438 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:11:38.214184 [info ] [MainThread]: 
[0m01:11:38.215088 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:11:38.220600 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_portfolio-ecommerce-pipeline'
[0m01:11:38.221434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:11:39.569996 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_portfolio-ecommerce-pipeline_dbt_mos'
[0m01:11:39.570603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:11:40.769706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '252a6516-18e1-451b-a1cf-66b2d9638532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001647BE83D40>]}
[0m01:11:40.770226 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:11:40.811310 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.stg_events
[0m01:11:40.812252 [info ] [Thread-1 (]: 1 of 12 START sql view model dbt_mos.stg_events ................................ [RUN]
[0m01:11:40.813308 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ecommerce_pipeline.stg_events'
[0m01:11:40.813764 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.stg_events
[0m01:11:40.820732 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.stg_events"
[0m01:11:40.822308 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.stg_events
[0m01:11:40.860493 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.stg_events"
[0m01:11:40.861933 [debug] [Thread-1 (]: On model.ecommerce_pipeline.stg_events: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.stg_events"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_events`
  OPTIONS()
  as with source as (
    select * from `bigquery-public-data.thelook_ecommerce.events`
)

select
    id as event_id,
    user_id,
    session_id,
    event_type,
    uri as page_url,
    created_at as event_time,
    traffic_source,
    browser,
    city,
    state,
    country
from source;


[0m01:11:40.862568 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:11:42.454889 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:40450fef-08a3-4d30-8a3b-3a7ee0a27bd5&page=queryresults
[0m01:11:42.717298 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:40450fef-08a3-4d30-8a3b-3a7ee0a27bd5&page=queryresults
[0m01:11:42.920098 [debug] [Thread-1 (]: Database Error in model stg_events (models\staging\stg_events.sql)
  Unrecognized name: country at [21:5]
  compiled code at target\run\ecommerce_pipeline\models\staging\stg_events.sql
[0m01:11:42.922491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '252a6516-18e1-451b-a1cf-66b2d9638532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001647BC4EBD0>]}
[0m01:11:42.923231 [error] [Thread-1 (]: 1 of 12 ERROR creating sql view model dbt_mos.stg_events ....................... [[31mERROR[0m in 2.11s]
[0m01:11:42.924157 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.stg_events
[0m01:11:42.924671 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.stg_order_items
[0m01:11:42.925272 [debug] [Thread-4 (]: Marking all children of 'model.ecommerce_pipeline.stg_events' to be skipped because of status 'error'.  Reason: Database Error in model stg_events (models\staging\stg_events.sql)
  Unrecognized name: country at [21:5]
  compiled code at target\run\ecommerce_pipeline\models\staging\stg_events.sql.
[0m01:11:42.925820 [info ] [Thread-1 (]: 2 of 12 START sql view model dbt_mos.stg_order_items ........................... [RUN]
[0m01:11:42.927056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.stg_events, now model.ecommerce_pipeline.stg_order_items)
[0m01:11:42.927486 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.stg_order_items
[0m01:11:42.929436 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.stg_order_items"
[0m01:11:42.930621 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.stg_order_items
[0m01:11:42.933501 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.stg_order_items"
[0m01:11:42.934542 [debug] [Thread-1 (]: On model.ecommerce_pipeline.stg_order_items: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.stg_order_items"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_order_items`
  OPTIONS()
  as with source as (
    select * from `bigquery-public-data.thelook_ecommerce.order_items`
)

select
    id as order_item_id,
    order_id,
    user_id,
    product_id,
    sale_price,
    created_at as ordered_at,
    shipped_at,
    delivered_at,
    returned_at,
    status
from source;


[0m01:11:42.935027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:44.551907 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:c4c6b423-3319-4cd6-ae3c-7a3cae00fc8b&page=queryresults
[0m01:11:45.086230 [debug] [Thread-1 (]: SQL status: OK in 0.534 seconds
[0m01:11:45.169347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '252a6516-18e1-451b-a1cf-66b2d9638532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001647BEB5E90>]}
[0m01:11:45.170033 [info ] [Thread-1 (]: 2 of 12 OK created sql view model dbt_mos.stg_order_items ...................... [[32mCREATE VIEW (0 processed)[0m in 2.24s]
[0m01:11:45.171144 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.stg_order_items
[0m01:11:45.171658 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.stg_orders
[0m01:11:45.172277 [info ] [Thread-1 (]: 3 of 12 START sql view model dbt_mos.stg_orders ................................ [RUN]
[0m01:11:45.173055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.stg_order_items, now model.ecommerce_pipeline.stg_orders)
[0m01:11:45.173384 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.stg_orders
[0m01:11:45.174880 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.stg_orders"
[0m01:11:45.175801 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.stg_orders
[0m01:11:45.178976 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.stg_orders"
[0m01:11:45.179976 [debug] [Thread-1 (]: On model.ecommerce_pipeline.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.stg_orders"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_orders`
  OPTIONS()
  as with source as (
    select * from `bigquery-public-data.thelook_ecommerce.orders`
)

select
    order_id,
    user_id,
    status,
    created_at as order_date,
    num_of_item as item_count
from source;


[0m01:11:45.180483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:46.606918 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:20f7abd8-275b-4c45-b7cd-1661e268ccda&page=queryresults
[0m01:11:47.141912 [debug] [Thread-1 (]: SQL status: OK in 0.534 seconds
[0m01:11:47.148340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '252a6516-18e1-451b-a1cf-66b2d9638532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001647BEA5450>]}
[0m01:11:47.149008 [info ] [Thread-1 (]: 3 of 12 OK created sql view model dbt_mos.stg_orders ........................... [[32mCREATE VIEW (0 processed)[0m in 1.98s]
[0m01:11:47.150501 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.stg_orders
[0m01:11:47.151088 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.stg_products
[0m01:11:47.151737 [info ] [Thread-1 (]: 4 of 12 START sql view model dbt_mos.stg_products .............................. [RUN]
[0m01:11:47.152576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.stg_orders, now model.ecommerce_pipeline.stg_products)
[0m01:11:47.152992 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.stg_products
[0m01:11:47.154935 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.stg_products"
[0m01:11:47.156292 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.stg_products
[0m01:11:47.160065 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.stg_products"
[0m01:11:47.161405 [debug] [Thread-1 (]: On model.ecommerce_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.stg_products"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_products`
  OPTIONS()
  as with source as (
    select * from `bigquery-public-data.thelook_ecommerce.products`
)

select
    id as product_id,
    name as product_name,
    category,
    brand,
    department,
    cost,
    retail_price
from source;


[0m01:11:47.162117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:48.682994 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:33df4752-a340-433d-bc5c-5d5622e21222&page=queryresults
[0m01:11:49.205000 [debug] [Thread-1 (]: SQL status: OK in 0.521 seconds
[0m01:11:49.209652 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '252a6516-18e1-451b-a1cf-66b2d9638532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001647C608FD0>]}
[0m01:11:49.210478 [info ] [Thread-1 (]: 4 of 12 OK created sql view model dbt_mos.stg_products ......................... [[32mCREATE VIEW (0 processed)[0m in 2.06s]
[0m01:11:49.211638 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.stg_products
[0m01:11:49.212079 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.stg_users
[0m01:11:49.212799 [info ] [Thread-1 (]: 5 of 12 START sql view model dbt_mos.stg_users ................................. [RUN]
[0m01:11:49.214206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.stg_products, now model.ecommerce_pipeline.stg_users)
[0m01:11:49.214810 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.stg_users
[0m01:11:49.216810 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.stg_users"
[0m01:11:49.217933 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.stg_users
[0m01:11:49.221315 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.stg_users"
[0m01:11:49.222371 [debug] [Thread-1 (]: On model.ecommerce_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.stg_users"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_users`
  OPTIONS()
  as with source as (
    select * from `bigquery-public-data.thelook_ecommerce.users`
)

select
    id as user_id,
    first_name,
    last_name,
    email,
    country,
    created_at as signup_date
from source;


[0m01:11:49.222950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:50.962146 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:1cda22a3-280b-4ff3-aea0-e0ea73332deb&page=queryresults
[0m01:11:51.474395 [debug] [Thread-1 (]: SQL status: OK in 0.512 seconds
[0m01:11:51.478912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '252a6516-18e1-451b-a1cf-66b2d9638532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000164745F72A0>]}
[0m01:11:51.480338 [info ] [Thread-1 (]: 5 of 12 OK created sql view model dbt_mos.stg_users ............................ [[32mCREATE VIEW (0 processed)[0m in 2.27s]
[0m01:11:51.482801 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.stg_users
[0m01:11:51.483354 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.int_order_items_with_products
[0m01:11:51.484299 [info ] [Thread-1 (]: 6 of 12 START sql view model dbt_mos.int_order_items_with_products ............. [RUN]
[0m01:11:51.485325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.stg_users, now model.ecommerce_pipeline.int_order_items_with_products)
[0m01:11:51.485681 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.int_order_items_with_products
[0m01:11:51.490503 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.int_order_items_with_products"
[0m01:11:51.491782 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.int_order_items_with_products
[0m01:11:51.494790 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.int_order_items_with_products"
[0m01:11:51.497412 [debug] [Thread-1 (]: On model.ecommerce_pipeline.int_order_items_with_products: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.int_order_items_with_products"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`int_order_items_with_products`
  OPTIONS()
  as with order_items as (
    select * from `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_order_items`
),

products as (
    select * from `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_products`
)

select
    oi.order_item_id,
    oi.order_id,
    oi.user_id,
    oi.product_id,
    p.product_name,
    p.category,
    p.brand,
    p.department,
    p.cost,
    p.retail_price,
    oi.sale_price,
    oi.sale_price - p.cost as profit,
    oi.ordered_at,
    oi.shipped_at,
    oi.delivered_at,
    oi.returned_at,
    oi.status
from order_items oi
left join products p on oi.product_id = p.product_id;


[0m01:11:51.498692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:53.619774 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:3df68d1f-d827-43f8-9b30-989db2caea82&page=queryresults
[0m01:11:54.132826 [debug] [Thread-1 (]: SQL status: OK in 0.513 seconds
[0m01:11:54.136955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '252a6516-18e1-451b-a1cf-66b2d9638532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001647C5676B0>]}
[0m01:11:54.137503 [info ] [Thread-1 (]: 6 of 12 OK created sql view model dbt_mos.int_order_items_with_products ........ [[32mCREATE VIEW (0 processed)[0m in 2.65s]
[0m01:11:54.138623 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.int_order_items_with_products
[0m01:11:54.139120 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.int_customer_orders
[0m01:11:54.139827 [info ] [Thread-1 (]: 7 of 12 START sql view model dbt_mos.int_customer_orders ....................... [RUN]
[0m01:11:54.140658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.int_order_items_with_products, now model.ecommerce_pipeline.int_customer_orders)
[0m01:11:54.141498 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.int_customer_orders
[0m01:11:54.145430 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.int_customer_orders"
[0m01:11:54.146924 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.int_customer_orders
[0m01:11:54.150231 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.int_customer_orders"
[0m01:11:54.151828 [debug] [Thread-1 (]: On model.ecommerce_pipeline.int_customer_orders: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.int_customer_orders"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`int_customer_orders`
  OPTIONS()
  as with users as (
    select * from `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_users`
),

order_items as (
    select * from `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_order_items`
)

select
    u.user_id,
    u.first_name,
    u.last_name,
    u.country,
    u.signup_date,
    count(distinct oi.order_id) as total_orders,
    count(oi.order_item_id) as total_items,
    sum(oi.sale_price) as total_revenue,
    min(oi.ordered_at) as first_order_date,
    max(oi.ordered_at) as last_order_date
from users u
left join order_items oi on u.user_id = oi.user_id
group by 1, 2, 3, 4, 5;


[0m01:11:54.152369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:55.707043 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:1681ff30-8f83-4378-a15f-dd80f855b911&page=queryresults
[0m01:11:56.266734 [debug] [Thread-1 (]: SQL status: OK in 0.559 seconds
[0m01:11:56.272004 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '252a6516-18e1-451b-a1cf-66b2d9638532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001647C688A10>]}
[0m01:11:56.272729 [info ] [Thread-1 (]: 7 of 12 OK created sql view model dbt_mos.int_customer_orders .................. [[32mCREATE VIEW (0 processed)[0m in 2.13s]
[0m01:11:56.273832 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.int_customer_orders
[0m01:11:56.274280 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.int_orders_with_users
[0m01:11:56.275071 [info ] [Thread-1 (]: 8 of 12 START sql view model dbt_mos.int_orders_with_users ..................... [RUN]
[0m01:11:56.275908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.int_customer_orders, now model.ecommerce_pipeline.int_orders_with_users)
[0m01:11:56.276316 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.int_orders_with_users
[0m01:11:56.279400 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.int_orders_with_users"
[0m01:11:56.280494 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.int_orders_with_users
[0m01:11:56.283726 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.int_orders_with_users"
[0m01:11:56.284849 [debug] [Thread-1 (]: On model.ecommerce_pipeline.int_orders_with_users: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.int_orders_with_users"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`int_orders_with_users`
  OPTIONS()
  as with orders as (
    select * from `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_orders`
),

users as (
    select * from `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_users`
)

select
    o.order_id,
    o.order_date,
    o.status,
    o.item_count,
    u.user_id,
    u.first_name,
    u.last_name,
    u.country
from orders o
left join users u on o.user_id = u.user_id;


[0m01:11:56.285409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:58.531323 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:ab6d7523-3719-4cd9-855c-18ce793be721&page=queryresults
[0m01:11:59.421166 [debug] [Thread-1 (]: SQL status: OK in 0.889 seconds
[0m01:11:59.425793 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '252a6516-18e1-451b-a1cf-66b2d9638532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001647C689970>]}
[0m01:11:59.426447 [info ] [Thread-1 (]: 8 of 12 OK created sql view model dbt_mos.int_orders_with_users ................ [[32mCREATE VIEW (0 processed)[0m in 3.15s]
[0m01:11:59.427654 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.int_orders_with_users
[0m01:11:59.428267 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.fct_monthly_revenue
[0m01:11:59.428955 [info ] [Thread-1 (]: 9 of 12 START sql view model dbt_mos.fct_monthly_revenue ....................... [RUN]
[0m01:11:59.429886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.int_orders_with_users, now model.ecommerce_pipeline.fct_monthly_revenue)
[0m01:11:59.430196 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.fct_monthly_revenue
[0m01:11:59.432575 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.fct_monthly_revenue"
[0m01:11:59.433598 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.fct_monthly_revenue
[0m01:11:59.436149 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.fct_monthly_revenue"
[0m01:11:59.437761 [debug] [Thread-1 (]: On model.ecommerce_pipeline.fct_monthly_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.fct_monthly_revenue"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`fct_monthly_revenue`
  OPTIONS()
  as with order_items as (
    select * from `portfolio-ecommerce-pipeline`.`dbt_mos`.`int_order_items_with_products`
)

select
    date_trunc(ordered_at, month) as month,
    category,
    department,
    count(distinct order_id) as total_orders,
    count(order_item_id) as total_items,
    sum(sale_price) as total_revenue,
    sum(profit) as total_profit,
    avg(sale_price) as avg_order_value
from order_items
where status != 'Cancelled'
group by 1, 2, 3;


[0m01:11:59.438273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:12:02.612959 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:ca50ef82-73a4-4a12-8e40-d37d163bf950&page=queryresults
[0m01:12:03.230810 [debug] [Thread-1 (]: SQL status: OK in 0.617 seconds
[0m01:12:03.235763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '252a6516-18e1-451b-a1cf-66b2d9638532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001647C68A390>]}
[0m01:12:03.236443 [info ] [Thread-1 (]: 9 of 12 OK created sql view model dbt_mos.fct_monthly_revenue .................. [[32mCREATE VIEW (0 processed)[0m in 3.81s]
[0m01:12:03.237542 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.fct_monthly_revenue
[0m01:12:03.237893 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.fct_product_performance
[0m01:12:03.238461 [info ] [Thread-1 (]: 10 of 12 START sql view model dbt_mos.fct_product_performance .................. [RUN]
[0m01:12:03.239256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.fct_monthly_revenue, now model.ecommerce_pipeline.fct_product_performance)
[0m01:12:03.239603 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.fct_product_performance
[0m01:12:03.242267 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.fct_product_performance"
[0m01:12:03.244062 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.fct_product_performance
[0m01:12:03.246551 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.fct_product_performance"
[0m01:12:03.247928 [debug] [Thread-1 (]: On model.ecommerce_pipeline.fct_product_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.fct_product_performance"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`fct_product_performance`
  OPTIONS()
  as with order_items as (
    select * from `portfolio-ecommerce-pipeline`.`dbt_mos`.`int_order_items_with_products`
)

select
    product_id,
    product_name,
    category,
    brand,
    department,
    count(distinct order_id) as times_ordered,
    sum(sale_price) as total_revenue,
    sum(profit) as total_profit,
    avg(sale_price) as avg_sale_price,
    sum(case when status = 'Returned' then 1 else 0 end) as return_count
from order_items
group by 1, 2, 3, 4, 5;


[0m01:12:03.248480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:12:05.191085 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:d76de939-30f8-478b-be51-903ec1157c06&page=queryresults
[0m01:12:05.717387 [debug] [Thread-1 (]: SQL status: OK in 0.526 seconds
[0m01:12:05.721162 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '252a6516-18e1-451b-a1cf-66b2d9638532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001647C68AB10>]}
[0m01:12:05.721786 [info ] [Thread-1 (]: 10 of 12 OK created sql view model dbt_mos.fct_product_performance ............. [[32mCREATE VIEW (0 processed)[0m in 2.48s]
[0m01:12:05.722874 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.fct_product_performance
[0m01:12:05.723254 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.fct_customer_lifetime_value
[0m01:12:05.723863 [info ] [Thread-1 (]: 11 of 12 START sql view model dbt_mos.fct_customer_lifetime_value .............. [RUN]
[0m01:12:05.724711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.fct_product_performance, now model.ecommerce_pipeline.fct_customer_lifetime_value)
[0m01:12:05.725151 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.fct_customer_lifetime_value
[0m01:12:05.727395 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.fct_customer_lifetime_value"
[0m01:12:05.728737 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.fct_customer_lifetime_value
[0m01:12:05.732056 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.fct_customer_lifetime_value"
[0m01:12:05.733751 [debug] [Thread-1 (]: On model.ecommerce_pipeline.fct_customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.fct_customer_lifetime_value"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`fct_customer_lifetime_value`
  OPTIONS()
  as with customer_orders as (
    select * from `portfolio-ecommerce-pipeline`.`dbt_mos`.`int_customer_orders`
)

select
    user_id,
    first_name,
    last_name,
    country,
    signup_date,
    total_orders,
    total_items,
    total_revenue,
    first_order_date,
    last_order_date,
    date_diff(last_order_date, first_order_date, day) as customer_lifespan_days,
    case
        when total_revenue >= 500 then 'High Value'
        when total_revenue >= 100 then 'Medium Value'
        else 'Low Value'
    end as customer_segment
from customer_orders
where total_orders > 0;


[0m01:12:05.734520 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:12:07.896625 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:2c3d8e7d-fa29-4084-a15f-2e8ea3221be6&page=queryresults
[0m01:12:08.511984 [debug] [Thread-1 (]: SQL status: OK in 0.615 seconds
[0m01:12:08.515907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '252a6516-18e1-451b-a1cf-66b2d9638532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001647C68B410>]}
[0m01:12:08.516437 [info ] [Thread-1 (]: 11 of 12 OK created sql view model dbt_mos.fct_customer_lifetime_value ......... [[32mCREATE VIEW (0 processed)[0m in 2.79s]
[0m01:12:08.517636 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.fct_customer_lifetime_value
[0m01:12:08.518006 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.fct_daily_sales
[0m01:12:08.518507 [info ] [Thread-1 (]: 12 of 12 START sql view model dbt_mos.fct_daily_sales .......................... [RUN]
[0m01:12:08.519260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.fct_customer_lifetime_value, now model.ecommerce_pipeline.fct_daily_sales)
[0m01:12:08.519657 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.fct_daily_sales
[0m01:12:08.521860 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.fct_daily_sales"
[0m01:12:08.522805 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.fct_daily_sales
[0m01:12:08.525826 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.fct_daily_sales"
[0m01:12:08.526899 [debug] [Thread-1 (]: On model.ecommerce_pipeline.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.fct_daily_sales"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`fct_daily_sales`
  OPTIONS()
  as with orders as (
    select * from `portfolio-ecommerce-pipeline`.`dbt_mos`.`int_orders_with_users`
)

select
    date(order_date) as sale_date,
    country,
    count(distinct order_id) as total_orders,
    count(distinct user_id) as unique_customers,
    sum(item_count) as total_items_sold
from orders
where status = 'Complete'
group by 1, 2;


[0m01:12:08.527414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:12:10.566936 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:a63f1859-675a-4d88-804c-b25596f493bd&page=queryresults
[0m01:12:11.080356 [debug] [Thread-1 (]: SQL status: OK in 0.513 seconds
[0m01:12:11.083842 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '252a6516-18e1-451b-a1cf-66b2d9638532', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001647C68BDD0>]}
[0m01:12:11.084381 [info ] [Thread-1 (]: 12 of 12 OK created sql view model dbt_mos.fct_daily_sales ..................... [[32mCREATE VIEW (0 processed)[0m in 2.56s]
[0m01:12:11.085841 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.fct_daily_sales
[0m01:12:11.087808 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:12:11.131249 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:12:11.131566 [debug] [MainThread]: Connection 'list_portfolio-ecommerce-pipeline' was properly closed.
[0m01:12:11.131838 [debug] [MainThread]: Connection 'list_portfolio-ecommerce-pipeline_dbt_mos' was properly closed.
[0m01:12:11.132066 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.fct_daily_sales' was properly closed.
[0m01:12:11.132383 [info ] [MainThread]: 
[0m01:12:11.132992 [info ] [MainThread]: Finished running 12 view models in 0 hours 0 minutes and 32.92 seconds (32.92s).
[0m01:12:11.136847 [debug] [MainThread]: Command end result
[0m01:12:11.169739 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\ecommerce_pipeline\target\manifest.json
[0m01:12:11.172830 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\ecommerce_pipeline\target\semantic_manifest.json
[0m01:12:11.180560 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\musta\ecommerce_pipeline\target\run_results.json
[0m01:12:11.180959 [info ] [MainThread]: 
[0m01:12:11.181662 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:12:11.182423 [info ] [MainThread]: 
[0m01:12:11.183133 [error] [MainThread]: [31mFailure in model stg_events (models\staging\stg_events.sql)[0m
[0m01:12:11.183731 [error] [MainThread]:   Database Error in model stg_events (models\staging\stg_events.sql)
  Unrecognized name: country at [21:5]
  compiled code at target\run\ecommerce_pipeline\models\staging\stg_events.sql
[0m01:12:11.184341 [info ] [MainThread]: 
[0m01:12:11.185235 [info ] [MainThread]:   compiled code at target\compiled\ecommerce_pipeline\models\staging\stg_events.sql
[0m01:12:11.186026 [info ] [MainThread]: 
[0m01:12:11.186775 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=12
[0m01:12:11.188334 [debug] [MainThread]: Command `dbt run` failed at 01:12:11.188141 after 57.56 seconds
[0m01:12:11.188856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001647BC62A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001647BC27E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001647C68BA70>]}
[0m01:12:11.189176 [debug] [MainThread]: Flushing usage events
[0m01:12:13.165744 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:22:39.539100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5E5F31160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5E72A3ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5E72A3B10>]}


============================== 01:22:39.543899 | 56b16ca1-a13f-4735-b21c-29e1843e7a79 ==============================
[0m01:22:39.543899 [info ] [MainThread]: Running with dbt=1.11.4
[0m01:22:39.544655 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\musta\\ecommerce_pipeline\\logs'}
[0m01:23:02.665754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56b16ca1-a13f-4735-b21c-29e1843e7a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5E65A1810>]}
[0m01:23:02.774711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56b16ca1-a13f-4735-b21c-29e1843e7a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C584381AE0>]}
[0m01:23:02.775674 [info ] [MainThread]: Registered adapter: bigquery=1.11.0
[0m01:23:03.831963 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m01:23:04.052659 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:23:04.053398 [debug] [MainThread]: Partial parsing: updated file: ecommerce_pipeline://models\staging\stg_events.sql
[0m01:23:04.445611 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_pipeline.example
[0m01:23:04.451649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56b16ca1-a13f-4735-b21c-29e1843e7a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C584FCE750>]}
[0m01:23:04.575620 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\ecommerce_pipeline\target\manifest.json
[0m01:23:04.579122 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\ecommerce_pipeline\target\semantic_manifest.json
[0m01:23:04.622752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56b16ca1-a13f-4735-b21c-29e1843e7a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5E5EDC320>]}
[0m01:23:04.623595 [info ] [MainThread]: Found 12 models, 4 data tests, 538 macros
[0m01:23:04.624659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56b16ca1-a13f-4735-b21c-29e1843e7a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C58518BCB0>]}
[0m01:23:04.629194 [info ] [MainThread]: 
[0m01:23:04.630199 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:23:04.631665 [info ] [MainThread]: 
[0m01:23:04.633522 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:23:04.642739 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_portfolio-ecommerce-pipeline'
[0m01:23:04.643468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:23:07.352048 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_portfolio-ecommerce-pipeline_dbt_mos'
[0m01:23:07.352620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:23:10.305188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56b16ca1-a13f-4735-b21c-29e1843e7a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C585318EF0>]}
[0m01:23:10.305767 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:23:10.363957 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.stg_events
[0m01:23:10.364598 [info ] [Thread-1 (]: 1 of 12 START sql view model dbt_mos.stg_events ................................ [RUN]
[0m01:23:10.365716 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ecommerce_pipeline.stg_events'
[0m01:23:10.366250 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.stg_events
[0m01:23:10.375209 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.stg_events"
[0m01:23:10.376513 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.stg_events
[0m01:23:10.426668 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.stg_events"
[0m01:23:10.428316 [debug] [Thread-1 (]: On model.ecommerce_pipeline.stg_events: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.stg_events"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_events`
  OPTIONS()
  as with source as (
    select * from `bigquery-public-data.thelook_ecommerce.events`
)

select
    id as event_id,
    user_id,
    session_id,
    event_type,
    uri as page_url,
    created_at as event_time,
    traffic_source,
    browser
from source;


[0m01:23:10.429182 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:23:12.518749 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:0d74e8e8-8f0a-4859-a0ad-dd10c4d68f10&page=queryresults
[0m01:23:13.052870 [debug] [Thread-1 (]: SQL status: OK in 0.533 seconds
[0m01:23:15.824520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56b16ca1-a13f-4735-b21c-29e1843e7a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C584FAFE90>]}
[0m01:23:15.825371 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dbt_mos.stg_events ........................... [[32mCREATE VIEW (0 processed)[0m in 5.46s]
[0m01:23:15.826329 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.stg_events
[0m01:23:15.826959 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.stg_order_items
[0m01:23:15.827865 [info ] [Thread-1 (]: 2 of 12 START sql view model dbt_mos.stg_order_items ........................... [RUN]
[0m01:23:15.828592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.stg_events, now model.ecommerce_pipeline.stg_order_items)
[0m01:23:15.829179 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.stg_order_items
[0m01:23:15.831701 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.stg_order_items"
[0m01:23:15.832722 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.stg_order_items
[0m01:23:15.836145 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.stg_order_items"
[0m01:23:15.837199 [debug] [Thread-1 (]: On model.ecommerce_pipeline.stg_order_items: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.stg_order_items"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_order_items`
  OPTIONS()
  as with source as (
    select * from `bigquery-public-data.thelook_ecommerce.order_items`
)

select
    id as order_item_id,
    order_id,
    user_id,
    product_id,
    sale_price,
    created_at as ordered_at,
    shipped_at,
    delivered_at,
    returned_at,
    status
from source;


[0m01:23:15.838043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:23:17.390447 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:00f9e834-93b6-42e1-92d3-8a885b7c2e99&page=queryresults
[0m01:23:17.940358 [debug] [Thread-1 (]: SQL status: OK in 0.549 seconds
[0m01:23:17.948249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56b16ca1-a13f-4735-b21c-29e1843e7a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5853A9A70>]}
[0m01:23:17.949096 [info ] [Thread-1 (]: 2 of 12 OK created sql view model dbt_mos.stg_order_items ...................... [[32mCREATE VIEW (0 processed)[0m in 2.12s]
[0m01:23:17.950482 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.stg_order_items
[0m01:23:17.951397 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.stg_orders
[0m01:23:17.952189 [info ] [Thread-1 (]: 3 of 12 START sql view model dbt_mos.stg_orders ................................ [RUN]
[0m01:23:17.953253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.stg_order_items, now model.ecommerce_pipeline.stg_orders)
[0m01:23:17.953893 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.stg_orders
[0m01:23:17.965001 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.stg_orders"
[0m01:23:17.966176 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.stg_orders
[0m01:23:17.974851 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.stg_orders"
[0m01:23:17.976394 [debug] [Thread-1 (]: On model.ecommerce_pipeline.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.stg_orders"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_orders`
  OPTIONS()
  as with source as (
    select * from `bigquery-public-data.thelook_ecommerce.orders`
)

select
    order_id,
    user_id,
    status,
    created_at as order_date,
    num_of_item as item_count
from source;


[0m01:23:17.977321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:23:19.909434 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:3d77fbb7-7a90-401e-b78b-6364ab2dc3e1&page=queryresults
[0m01:23:20.451252 [debug] [Thread-1 (]: SQL status: OK in 0.541 seconds
[0m01:23:20.455996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56b16ca1-a13f-4735-b21c-29e1843e7a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5859E0870>]}
[0m01:23:20.456790 [info ] [Thread-1 (]: 3 of 12 OK created sql view model dbt_mos.stg_orders ........................... [[32mCREATE VIEW (0 processed)[0m in 2.50s]
[0m01:23:20.457855 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.stg_orders
[0m01:23:20.458281 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.stg_products
[0m01:23:20.458900 [info ] [Thread-1 (]: 4 of 12 START sql view model dbt_mos.stg_products .............................. [RUN]
[0m01:23:20.459831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.stg_orders, now model.ecommerce_pipeline.stg_products)
[0m01:23:20.460388 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.stg_products
[0m01:23:20.462192 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.stg_products"
[0m01:23:20.463336 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.stg_products
[0m01:23:20.466567 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.stg_products"
[0m01:23:20.467706 [debug] [Thread-1 (]: On model.ecommerce_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.stg_products"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_products`
  OPTIONS()
  as with source as (
    select * from `bigquery-public-data.thelook_ecommerce.products`
)

select
    id as product_id,
    name as product_name,
    category,
    brand,
    department,
    cost,
    retail_price
from source;


[0m01:23:20.468245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:23:22.296036 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:723f7334-af39-41b6-87d1-aa4632266dea&page=queryresults
[0m01:23:22.837805 [debug] [Thread-1 (]: SQL status: OK in 0.541 seconds
[0m01:23:22.845737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56b16ca1-a13f-4735-b21c-29e1843e7a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5859D66D0>]}
[0m01:23:22.846947 [info ] [Thread-1 (]: 4 of 12 OK created sql view model dbt_mos.stg_products ......................... [[32mCREATE VIEW (0 processed)[0m in 2.39s]
[0m01:23:22.848602 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.stg_products
[0m01:23:22.849458 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.stg_users
[0m01:23:22.850607 [info ] [Thread-1 (]: 5 of 12 START sql view model dbt_mos.stg_users ................................. [RUN]
[0m01:23:22.851660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.stg_products, now model.ecommerce_pipeline.stg_users)
[0m01:23:22.852285 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.stg_users
[0m01:23:22.855005 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.stg_users"
[0m01:23:22.856434 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.stg_users
[0m01:23:22.861401 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.stg_users"
[0m01:23:22.862927 [debug] [Thread-1 (]: On model.ecommerce_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.stg_users"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_users`
  OPTIONS()
  as with source as (
    select * from `bigquery-public-data.thelook_ecommerce.users`
)

select
    id as user_id,
    first_name,
    last_name,
    email,
    country,
    created_at as signup_date
from source;


[0m01:23:22.863878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:23:24.729215 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:a67a1fa9-d271-4b50-a012-d8a398a50945&page=queryresults
[0m01:23:25.228977 [debug] [Thread-1 (]: SQL status: OK in 0.499 seconds
[0m01:23:25.233927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56b16ca1-a13f-4735-b21c-29e1843e7a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C585ACA4A0>]}
[0m01:23:25.234743 [info ] [Thread-1 (]: 5 of 12 OK created sql view model dbt_mos.stg_users ............................ [[32mCREATE VIEW (0 processed)[0m in 2.38s]
[0m01:23:25.236146 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.stg_users
[0m01:23:25.236879 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.int_order_items_with_products
[0m01:23:25.237703 [info ] [Thread-1 (]: 6 of 12 START sql view model dbt_mos.int_order_items_with_products ............. [RUN]
[0m01:23:25.238551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.stg_users, now model.ecommerce_pipeline.int_order_items_with_products)
[0m01:23:25.239036 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.int_order_items_with_products
[0m01:23:25.242725 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.int_order_items_with_products"
[0m01:23:25.243890 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.int_order_items_with_products
[0m01:23:25.247773 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.int_order_items_with_products"
[0m01:23:25.249554 [debug] [Thread-1 (]: On model.ecommerce_pipeline.int_order_items_with_products: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.int_order_items_with_products"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`int_order_items_with_products`
  OPTIONS()
  as with order_items as (
    select * from `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_order_items`
),

products as (
    select * from `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_products`
)

select
    oi.order_item_id,
    oi.order_id,
    oi.user_id,
    oi.product_id,
    p.product_name,
    p.category,
    p.brand,
    p.department,
    p.cost,
    p.retail_price,
    oi.sale_price,
    oi.sale_price - p.cost as profit,
    oi.ordered_at,
    oi.shipped_at,
    oi.delivered_at,
    oi.returned_at,
    oi.status
from order_items oi
left join products p on oi.product_id = p.product_id;


[0m01:23:25.250497 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:23:27.469437 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:82cd3c17-b90d-45f9-8894-92c3fcd70db6&page=queryresults
[0m01:23:28.007306 [debug] [Thread-1 (]: SQL status: OK in 0.537 seconds
[0m01:23:28.012407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56b16ca1-a13f-4735-b21c-29e1843e7a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C585AB53D0>]}
[0m01:23:28.013402 [info ] [Thread-1 (]: 6 of 12 OK created sql view model dbt_mos.int_order_items_with_products ........ [[32mCREATE VIEW (0 processed)[0m in 2.77s]
[0m01:23:28.014527 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.int_order_items_with_products
[0m01:23:28.014918 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.int_customer_orders
[0m01:23:28.015827 [info ] [Thread-1 (]: 7 of 12 START sql view model dbt_mos.int_customer_orders ....................... [RUN]
[0m01:23:28.016670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.int_order_items_with_products, now model.ecommerce_pipeline.int_customer_orders)
[0m01:23:28.017208 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.int_customer_orders
[0m01:23:28.020061 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.int_customer_orders"
[0m01:23:28.021346 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.int_customer_orders
[0m01:23:28.024643 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.int_customer_orders"
[0m01:23:28.026193 [debug] [Thread-1 (]: On model.ecommerce_pipeline.int_customer_orders: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.int_customer_orders"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`int_customer_orders`
  OPTIONS()
  as with users as (
    select * from `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_users`
),

order_items as (
    select * from `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_order_items`
)

select
    u.user_id,
    u.first_name,
    u.last_name,
    u.country,
    u.signup_date,
    count(distinct oi.order_id) as total_orders,
    count(oi.order_item_id) as total_items,
    sum(oi.sale_price) as total_revenue,
    min(oi.ordered_at) as first_order_date,
    max(oi.ordered_at) as last_order_date
from users u
left join order_items oi on u.user_id = oi.user_id
group by 1, 2, 3, 4, 5;


[0m01:23:28.027101 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:23:29.630541 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:d3c7e5b7-985a-4c98-85d0-3b2da907fe12&page=queryresults
[0m01:23:30.122589 [debug] [Thread-1 (]: SQL status: OK in 0.491 seconds
[0m01:23:30.126608 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56b16ca1-a13f-4735-b21c-29e1843e7a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C585AB5E50>]}
[0m01:23:30.127237 [info ] [Thread-1 (]: 7 of 12 OK created sql view model dbt_mos.int_customer_orders .................. [[32mCREATE VIEW (0 processed)[0m in 2.11s]
[0m01:23:30.128449 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.int_customer_orders
[0m01:23:30.129010 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.int_orders_with_users
[0m01:23:30.129963 [info ] [Thread-1 (]: 8 of 12 START sql view model dbt_mos.int_orders_with_users ..................... [RUN]
[0m01:23:30.131151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.int_customer_orders, now model.ecommerce_pipeline.int_orders_with_users)
[0m01:23:30.131509 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.int_orders_with_users
[0m01:23:30.133902 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.int_orders_with_users"
[0m01:23:30.134851 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.int_orders_with_users
[0m01:23:30.137461 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.int_orders_with_users"
[0m01:23:30.139194 [debug] [Thread-1 (]: On model.ecommerce_pipeline.int_orders_with_users: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.int_orders_with_users"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`int_orders_with_users`
  OPTIONS()
  as with orders as (
    select * from `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_orders`
),

users as (
    select * from `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_users`
)

select
    o.order_id,
    o.order_date,
    o.status,
    o.item_count,
    u.user_id,
    u.first_name,
    u.last_name,
    u.country
from orders o
left join users u on o.user_id = u.user_id;


[0m01:23:30.139737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:23:31.814855 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:7bec421f-a2ca-4b55-bd40-0f2c362d60db&page=queryresults
[0m01:23:32.911905 [debug] [Thread-1 (]: SQL status: OK in 1.096 seconds
[0m01:23:32.920342 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56b16ca1-a13f-4735-b21c-29e1843e7a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C585AB67B0>]}
[0m01:23:32.921599 [info ] [Thread-1 (]: 8 of 12 OK created sql view model dbt_mos.int_orders_with_users ................ [[32mCREATE VIEW (0 processed)[0m in 2.79s]
[0m01:23:32.932233 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.int_orders_with_users
[0m01:23:32.933241 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.fct_monthly_revenue
[0m01:23:32.934425 [info ] [Thread-1 (]: 9 of 12 START sql view model dbt_mos.fct_monthly_revenue ....................... [RUN]
[0m01:23:32.936317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.int_orders_with_users, now model.ecommerce_pipeline.fct_monthly_revenue)
[0m01:23:32.937176 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.fct_monthly_revenue
[0m01:23:32.943158 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.fct_monthly_revenue"
[0m01:23:32.944777 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.fct_monthly_revenue
[0m01:23:32.949937 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.fct_monthly_revenue"
[0m01:23:32.951704 [debug] [Thread-1 (]: On model.ecommerce_pipeline.fct_monthly_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.fct_monthly_revenue"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`fct_monthly_revenue`
  OPTIONS()
  as with order_items as (
    select * from `portfolio-ecommerce-pipeline`.`dbt_mos`.`int_order_items_with_products`
)

select
    date_trunc(ordered_at, month) as month,
    category,
    department,
    count(distinct order_id) as total_orders,
    count(order_item_id) as total_items,
    sum(sale_price) as total_revenue,
    sum(profit) as total_profit,
    avg(sale_price) as avg_order_value
from order_items
where status != 'Cancelled'
group by 1, 2, 3;


[0m01:23:32.952757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:23:34.763274 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:5a2941d3-f464-4682-bdb2-176819e1ec57&page=queryresults
[0m01:23:35.286903 [debug] [Thread-1 (]: SQL status: OK in 0.523 seconds
[0m01:23:35.291960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56b16ca1-a13f-4735-b21c-29e1843e7a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C585AB6FF0>]}
[0m01:23:35.292684 [info ] [Thread-1 (]: 9 of 12 OK created sql view model dbt_mos.fct_monthly_revenue .................. [[32mCREATE VIEW (0 processed)[0m in 2.36s]
[0m01:23:35.293876 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.fct_monthly_revenue
[0m01:23:35.294288 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.fct_product_performance
[0m01:23:35.294793 [info ] [Thread-1 (]: 10 of 12 START sql view model dbt_mos.fct_product_performance .................. [RUN]
[0m01:23:35.295557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.fct_monthly_revenue, now model.ecommerce_pipeline.fct_product_performance)
[0m01:23:35.295936 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.fct_product_performance
[0m01:23:35.298386 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.fct_product_performance"
[0m01:23:35.299359 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.fct_product_performance
[0m01:23:35.301834 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.fct_product_performance"
[0m01:23:35.302791 [debug] [Thread-1 (]: On model.ecommerce_pipeline.fct_product_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.fct_product_performance"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`fct_product_performance`
  OPTIONS()
  as with order_items as (
    select * from `portfolio-ecommerce-pipeline`.`dbt_mos`.`int_order_items_with_products`
)

select
    product_id,
    product_name,
    category,
    brand,
    department,
    count(distinct order_id) as times_ordered,
    sum(sale_price) as total_revenue,
    sum(profit) as total_profit,
    avg(sale_price) as avg_sale_price,
    sum(case when status = 'Returned' then 1 else 0 end) as return_count
from order_items
group by 1, 2, 3, 4, 5;


[0m01:23:35.303298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:23:37.348580 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:757e6bd5-fba0-49b4-8abf-217c5d782832&page=queryresults
[0m01:23:37.870439 [debug] [Thread-1 (]: SQL status: OK in 0.521 seconds
[0m01:23:37.876677 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56b16ca1-a13f-4735-b21c-29e1843e7a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C585AB6ED0>]}
[0m01:23:37.877481 [info ] [Thread-1 (]: 10 of 12 OK created sql view model dbt_mos.fct_product_performance ............. [[32mCREATE VIEW (0 processed)[0m in 2.58s]
[0m01:23:37.878926 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.fct_product_performance
[0m01:23:37.879790 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.fct_customer_lifetime_value
[0m01:23:37.880510 [info ] [Thread-1 (]: 11 of 12 START sql view model dbt_mos.fct_customer_lifetime_value .............. [RUN]
[0m01:23:37.881263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.fct_product_performance, now model.ecommerce_pipeline.fct_customer_lifetime_value)
[0m01:23:37.881723 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.fct_customer_lifetime_value
[0m01:23:37.885622 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.fct_customer_lifetime_value"
[0m01:23:37.886757 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.fct_customer_lifetime_value
[0m01:23:37.889535 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.fct_customer_lifetime_value"
[0m01:23:37.891147 [debug] [Thread-1 (]: On model.ecommerce_pipeline.fct_customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.fct_customer_lifetime_value"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`fct_customer_lifetime_value`
  OPTIONS()
  as with customer_orders as (
    select * from `portfolio-ecommerce-pipeline`.`dbt_mos`.`int_customer_orders`
)

select
    user_id,
    first_name,
    last_name,
    country,
    signup_date,
    total_orders,
    total_items,
    total_revenue,
    first_order_date,
    last_order_date,
    date_diff(last_order_date, first_order_date, day) as customer_lifespan_days,
    case
        when total_revenue >= 500 then 'High Value'
        when total_revenue >= 100 then 'Medium Value'
        else 'Low Value'
    end as customer_segment
from customer_orders
where total_orders > 0;


[0m01:23:37.892143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:23:39.916428 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:9922c97d-df15-42c2-9e50-7cf0570d1f1c&page=queryresults
[0m01:23:40.431464 [debug] [Thread-1 (]: SQL status: OK in 0.514 seconds
[0m01:23:40.434936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56b16ca1-a13f-4735-b21c-29e1843e7a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C585AB4F50>]}
[0m01:23:40.435799 [info ] [Thread-1 (]: 11 of 12 OK created sql view model dbt_mos.fct_customer_lifetime_value ......... [[32mCREATE VIEW (0 processed)[0m in 2.55s]
[0m01:23:40.437505 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.fct_customer_lifetime_value
[0m01:23:40.437912 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.fct_daily_sales
[0m01:23:40.438583 [info ] [Thread-1 (]: 12 of 12 START sql view model dbt_mos.fct_daily_sales .......................... [RUN]
[0m01:23:40.439329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.fct_customer_lifetime_value, now model.ecommerce_pipeline.fct_daily_sales)
[0m01:23:40.439804 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.fct_daily_sales
[0m01:23:40.441911 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.fct_daily_sales"
[0m01:23:40.442842 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.fct_daily_sales
[0m01:23:40.445316 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.fct_daily_sales"
[0m01:23:40.446278 [debug] [Thread-1 (]: On model.ecommerce_pipeline.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.fct_daily_sales"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`fct_daily_sales`
  OPTIONS()
  as with orders as (
    select * from `portfolio-ecommerce-pipeline`.`dbt_mos`.`int_orders_with_users`
)

select
    date(order_date) as sale_date,
    country,
    count(distinct order_id) as total_orders,
    count(distinct user_id) as unique_customers,
    sum(item_count) as total_items_sold
from orders
where status = 'Complete'
group by 1, 2;


[0m01:23:40.446683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:23:42.671677 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:fedb8b1e-10a4-4da3-a3e7-858bcdaa608d&page=queryresults
[0m01:23:43.206670 [debug] [Thread-1 (]: SQL status: OK in 0.534 seconds
[0m01:23:43.217585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56b16ca1-a13f-4735-b21c-29e1843e7a79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C585B51130>]}
[0m01:23:43.218918 [info ] [Thread-1 (]: 12 of 12 OK created sql view model dbt_mos.fct_daily_sales ..................... [[32mCREATE VIEW (0 processed)[0m in 2.78s]
[0m01:23:43.222192 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.fct_daily_sales
[0m01:23:43.227283 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:23:43.356467 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:23:43.357860 [debug] [MainThread]: Connection 'list_portfolio-ecommerce-pipeline' was properly closed.
[0m01:23:43.358550 [debug] [MainThread]: Connection 'list_portfolio-ecommerce-pipeline_dbt_mos' was properly closed.
[0m01:23:43.359234 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.fct_daily_sales' was properly closed.
[0m01:23:43.359953 [info ] [MainThread]: 
[0m01:23:43.360931 [info ] [MainThread]: Finished running 12 view models in 0 hours 0 minutes and 38.73 seconds (38.73s).
[0m01:23:43.368916 [debug] [MainThread]: Command end result
[0m01:23:43.461430 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\ecommerce_pipeline\target\manifest.json
[0m01:23:43.468094 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\ecommerce_pipeline\target\semantic_manifest.json
[0m01:23:43.493838 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\musta\ecommerce_pipeline\target\run_results.json
[0m01:23:43.495050 [info ] [MainThread]: 
[0m01:23:43.499966 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:23:43.501468 [info ] [MainThread]: 
[0m01:23:43.502452 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m01:23:43.504288 [debug] [MainThread]: Command `dbt run` succeeded at 01:23:43.504004 after 64.09 seconds
[0m01:23:43.505132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C58517FB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C584FFC650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C585B53FB0>]}
[0m01:23:43.505908 [debug] [MainThread]: Flushing usage events
[0m01:23:45.076624 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:27:43.349759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020039DD1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002003B147ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002003B147B10>]}


============================== 01:27:43.355083 | 05997bdb-67b0-46a2-a5e5-c64e0873f208 ==============================
[0m01:27:43.355083 [info ] [MainThread]: Running with dbt=1.11.4
[0m01:27:43.356326 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'invocation_command': 'dbt docs generate', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\musta\\ecommerce_pipeline\\logs'}
[0m01:28:03.947283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05997bdb-67b0-46a2-a5e5-c64e0873f208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002003A451810>]}
[0m01:28:04.038218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05997bdb-67b0-46a2-a5e5-c64e0873f208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200581BDAE0>]}
[0m01:28:04.040220 [info ] [MainThread]: Registered adapter: bigquery=1.11.0
[0m01:28:04.998811 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m01:28:05.269889 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:28:05.270647 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m01:28:05.271205 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:28:05.280005 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_pipeline.example
[0m01:28:05.340584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05997bdb-67b0-46a2-a5e5-c64e0873f208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020058A1E050>]}
[0m01:28:05.382345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05997bdb-67b0-46a2-a5e5-c64e0873f208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020058B74500>]}
[0m01:28:05.383051 [info ] [MainThread]: Found 12 models, 4 data tests, 538 macros
[0m01:28:05.383843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05997bdb-67b0-46a2-a5e5-c64e0873f208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020058AD2970>]}
[0m01:28:05.387179 [info ] [MainThread]: 
[0m01:28:05.388304 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:28:05.389224 [info ] [MainThread]: 
[0m01:28:05.390540 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:28:05.396810 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_portfolio-ecommerce-pipeline_dbt_mos'
[0m01:28:05.397332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:28:07.162154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05997bdb-67b0-46a2-a5e5-c64e0873f208', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020058BB7790>]}
[0m01:28:07.162535 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:28:07.202781 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.stg_events
[0m01:28:07.203483 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ecommerce_pipeline.stg_events'
[0m01:28:07.203879 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.stg_events
[0m01:28:07.213340 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.stg_events"
[0m01:28:07.214438 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.stg_events
[0m01:28:07.215258 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:28:07.262167 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.stg_events
[0m01:28:07.262642 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.stg_order_items
[0m01:28:07.263119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.stg_events, now model.ecommerce_pipeline.stg_order_items)
[0m01:28:07.263447 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.stg_order_items
[0m01:28:07.265014 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.stg_order_items"
[0m01:28:07.265819 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.stg_order_items
[0m01:28:07.266306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:07.308183 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.stg_order_items
[0m01:28:07.308689 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.stg_orders
[0m01:28:07.309258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.stg_order_items, now model.ecommerce_pipeline.stg_orders)
[0m01:28:07.309715 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.stg_orders
[0m01:28:07.311802 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.stg_orders"
[0m01:28:07.312699 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.stg_orders
[0m01:28:07.313191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:07.357762 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.stg_orders
[0m01:28:07.358270 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.stg_products
[0m01:28:07.358898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.stg_orders, now model.ecommerce_pipeline.stg_products)
[0m01:28:07.359575 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.stg_products
[0m01:28:07.361610 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.stg_products"
[0m01:28:07.362684 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.stg_products
[0m01:28:07.363380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:07.415074 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.stg_products
[0m01:28:07.415566 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.stg_users
[0m01:28:07.416115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.stg_products, now model.ecommerce_pipeline.stg_users)
[0m01:28:07.416662 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.stg_users
[0m01:28:07.419140 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.stg_users"
[0m01:28:07.420316 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.stg_users
[0m01:28:07.421008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:07.462525 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.stg_users
[0m01:28:07.463010 [debug] [Thread-1 (]: Began running node test.ecommerce_pipeline.not_null_stg_orders_order_id.81cfe2fe64
[0m01:28:07.463542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.stg_users, now test.ecommerce_pipeline.not_null_stg_orders_order_id.81cfe2fe64)
[0m01:28:07.464094 [debug] [Thread-1 (]: Began compiling node test.ecommerce_pipeline.not_null_stg_orders_order_id.81cfe2fe64
[0m01:28:07.476493 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_pipeline.not_null_stg_orders_order_id.81cfe2fe64"
[0m01:28:07.477623 [debug] [Thread-1 (]: Began executing node test.ecommerce_pipeline.not_null_stg_orders_order_id.81cfe2fe64
[0m01:28:07.478144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:07.514922 [debug] [Thread-1 (]: Finished running node test.ecommerce_pipeline.not_null_stg_orders_order_id.81cfe2fe64
[0m01:28:07.515346 [debug] [Thread-1 (]: Began running node test.ecommerce_pipeline.unique_stg_orders_order_id.e3b841c71a
[0m01:28:07.515793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_pipeline.not_null_stg_orders_order_id.81cfe2fe64, now test.ecommerce_pipeline.unique_stg_orders_order_id.e3b841c71a)
[0m01:28:07.516106 [debug] [Thread-1 (]: Began compiling node test.ecommerce_pipeline.unique_stg_orders_order_id.e3b841c71a
[0m01:28:07.522858 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_pipeline.unique_stg_orders_order_id.e3b841c71a"
[0m01:28:07.523677 [debug] [Thread-1 (]: Began executing node test.ecommerce_pipeline.unique_stg_orders_order_id.e3b841c71a
[0m01:28:07.524156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:07.562189 [debug] [Thread-1 (]: Finished running node test.ecommerce_pipeline.unique_stg_orders_order_id.e3b841c71a
[0m01:28:07.562604 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.int_order_items_with_products
[0m01:28:07.563055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_pipeline.unique_stg_orders_order_id.e3b841c71a, now model.ecommerce_pipeline.int_order_items_with_products)
[0m01:28:07.563365 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.int_order_items_with_products
[0m01:28:07.565708 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.int_order_items_with_products"
[0m01:28:07.566986 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.int_order_items_with_products
[0m01:28:07.567775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:07.607850 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.int_order_items_with_products
[0m01:28:07.608472 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.int_customer_orders
[0m01:28:07.609049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.int_order_items_with_products, now model.ecommerce_pipeline.int_customer_orders)
[0m01:28:07.609520 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.int_customer_orders
[0m01:28:07.612806 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.int_customer_orders"
[0m01:28:07.614000 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.int_customer_orders
[0m01:28:07.614497 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:07.659412 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.int_customer_orders
[0m01:28:07.660167 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.int_orders_with_users
[0m01:28:07.661123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.int_customer_orders, now model.ecommerce_pipeline.int_orders_with_users)
[0m01:28:07.661686 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.int_orders_with_users
[0m01:28:07.664049 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.int_orders_with_users"
[0m01:28:07.664924 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.int_orders_with_users
[0m01:28:07.665410 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:07.704377 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.int_orders_with_users
[0m01:28:07.704853 [debug] [Thread-1 (]: Began running node test.ecommerce_pipeline.not_null_stg_users_user_id.980dfc1b77
[0m01:28:07.705369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.int_orders_with_users, now test.ecommerce_pipeline.not_null_stg_users_user_id.980dfc1b77)
[0m01:28:07.705921 [debug] [Thread-1 (]: Began compiling node test.ecommerce_pipeline.not_null_stg_users_user_id.980dfc1b77
[0m01:28:07.710067 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_pipeline.not_null_stg_users_user_id.980dfc1b77"
[0m01:28:07.711054 [debug] [Thread-1 (]: Began executing node test.ecommerce_pipeline.not_null_stg_users_user_id.980dfc1b77
[0m01:28:07.711608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:07.750661 [debug] [Thread-1 (]: Finished running node test.ecommerce_pipeline.not_null_stg_users_user_id.980dfc1b77
[0m01:28:07.751118 [debug] [Thread-1 (]: Began running node test.ecommerce_pipeline.unique_stg_users_user_id.c2ff477e6b
[0m01:28:07.751616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_pipeline.not_null_stg_users_user_id.980dfc1b77, now test.ecommerce_pipeline.unique_stg_users_user_id.c2ff477e6b)
[0m01:28:07.752147 [debug] [Thread-1 (]: Began compiling node test.ecommerce_pipeline.unique_stg_users_user_id.c2ff477e6b
[0m01:28:07.757307 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_pipeline.unique_stg_users_user_id.c2ff477e6b"
[0m01:28:07.758289 [debug] [Thread-1 (]: Began executing node test.ecommerce_pipeline.unique_stg_users_user_id.c2ff477e6b
[0m01:28:07.758778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:07.802803 [debug] [Thread-1 (]: Finished running node test.ecommerce_pipeline.unique_stg_users_user_id.c2ff477e6b
[0m01:28:07.803218 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.fct_monthly_revenue
[0m01:28:07.803667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_pipeline.unique_stg_users_user_id.c2ff477e6b, now model.ecommerce_pipeline.fct_monthly_revenue)
[0m01:28:07.803987 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.fct_monthly_revenue
[0m01:28:07.806230 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.fct_monthly_revenue"
[0m01:28:07.807058 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.fct_monthly_revenue
[0m01:28:07.807597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:07.850263 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.fct_monthly_revenue
[0m01:28:07.850674 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.fct_product_performance
[0m01:28:07.851115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.fct_monthly_revenue, now model.ecommerce_pipeline.fct_product_performance)
[0m01:28:07.851430 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.fct_product_performance
[0m01:28:07.854725 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.fct_product_performance"
[0m01:28:07.855589 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.fct_product_performance
[0m01:28:07.856074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:07.891102 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.fct_product_performance
[0m01:28:07.891571 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.fct_customer_lifetime_value
[0m01:28:07.892009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.fct_product_performance, now model.ecommerce_pipeline.fct_customer_lifetime_value)
[0m01:28:07.892333 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.fct_customer_lifetime_value
[0m01:28:07.895116 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.fct_customer_lifetime_value"
[0m01:28:07.896051 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.fct_customer_lifetime_value
[0m01:28:07.896603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:07.931224 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.fct_customer_lifetime_value
[0m01:28:07.931634 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.fct_daily_sales
[0m01:28:07.932119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.fct_customer_lifetime_value, now model.ecommerce_pipeline.fct_daily_sales)
[0m01:28:07.932473 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.fct_daily_sales
[0m01:28:07.935088 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.fct_daily_sales"
[0m01:28:07.935963 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.fct_daily_sales
[0m01:28:07.936449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:07.972694 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.fct_daily_sales
[0m01:28:07.973988 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:28:07.974307 [debug] [MainThread]: Connection 'list_portfolio-ecommerce-pipeline_dbt_mos' was properly closed.
[0m01:28:07.974547 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.fct_daily_sales' was properly closed.
[0m01:28:07.977370 [debug] [MainThread]: Command end result
[0m01:28:08.061315 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\ecommerce_pipeline\target\manifest.json
[0m01:28:08.063725 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\ecommerce_pipeline\target\semantic_manifest.json
[0m01:28:08.071765 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\musta\ecommerce_pipeline\target\run_results.json
[0m01:28:08.074306 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m01:28:08.074730 [info ] [MainThread]: Building catalog
[0m01:28:08.082113 [debug] [ThreadPool]: Acquiring new bigquery connection 'portfolio-ecommerce-pipeline.information_schema'
[0m01:28:08.103357 [debug] [ThreadPool]: On portfolio-ecommerce-pipeline.information_schema: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "portfolio-ecommerce-pipeline.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `portfolio-ecommerce-pipeline`.`dbt_mos`.__TABLES__ tables
    left join `portfolio-ecommerce-pipeline`.`dbt_mos`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `portfolio-ecommerce-pipeline`.`dbt_mos`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dbt_mos')
                            and upper(table_name) = upper('stg_order_items')
                            ) or (
                                upper(table_schema) = upper('dbt_mos')
                            and upper(table_name) = upper('int_orders_with_users')
                            ) or (
                                upper(table_schema) = upper('dbt_mos')
                            and upper(table_name) = upper('fct_product_performance')
                            ) or (
                                upper(table_schema) = upper('dbt_mos')
                            and upper(table_name) = upper('int_order_items_with_products')
                            ) or (
                                upper(table_schema) = upper('dbt_mos')
                            and upper(table_name) = upper('fct_daily_sales')
                            ) or (
                                upper(table_schema) = upper('dbt_mos')
                            and upper(table_name) = upper('stg_users')
                            ) or (
                                upper(table_schema) = upper('dbt_mos')
                            and upper(table_name) = upper('stg_products')
                            ) or (
                                upper(table_schema) = upper('dbt_mos')
                            and upper(table_name) = upper('stg_orders')
                            ) or (
                                upper(table_schema) = upper('dbt_mos')
                            and upper(table_name) = upper('stg_events')
                            ) or (
                                upper(table_schema) = upper('dbt_mos')
                            and upper(table_name) = upper('int_customer_orders')
                            ) or (
                                upper(table_schema) = upper('dbt_mos')
                            and upper(table_name) = upper('fct_monthly_revenue')
                            ) or (
                                upper(table_schema) = upper('dbt_mos')
                            and upper(table_name) = upper('fct_customer_lifetime_value')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `portfolio-ecommerce-pipeline`.`dbt_mos`.INFORMATION_SCHEMA.COLUMNS columns
    join `portfolio-ecommerce-pipeline`.`dbt_mos`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m01:28:08.104256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:28:09.716310 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:36adeeee-a323-4ce0-a4b8-6a2c47d677e5&page=queryresults
[0m01:28:10.909780 [debug] [ThreadPool]: SQL status: OK in 1.193 seconds
[0m01:28:11.726691 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:28:11.784128 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\musta\ecommerce_pipeline\target\catalog.json
[0m01:28:11.817699 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\ecommerce_pipeline\target\manifest.json
[0m01:28:11.820359 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\ecommerce_pipeline\target\semantic_manifest.json
[0m01:28:11.820766 [info ] [MainThread]: Catalog written to C:\Users\musta\ecommerce_pipeline\target\catalog.json
[0m01:28:11.822028 [debug] [MainThread]: Command `dbt docs generate` succeeded at 01:28:11.821914 after 28.59 seconds
[0m01:28:11.822311 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m01:28:11.822599 [debug] [MainThread]: Connection 'portfolio-ecommerce-pipeline.information_schema' was properly closed.
[0m01:28:11.822876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002003AF26C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020058BC7E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020058BC7CD0>]}
[0m01:28:11.823182 [debug] [MainThread]: Flushing usage events
[0m01:28:12.926814 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:29:25.291399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024463B11160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024464E8FED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024464E8FB10>]}


============================== 01:29:25.296301 | 90fe89a1-516f-4529-9fb2-fda2c6543644 ==============================
[0m01:29:25.296301 [info ] [MainThread]: Running with dbt=1.11.4
[0m01:29:25.297118 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt docs serve', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\musta\\ecommerce_pipeline\\logs'}
[0m01:29:44.369496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90fe89a1-516f-4529-9fb2-fda2c6543644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024464191810>]}
[0m01:29:44.434699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90fe89a1-516f-4529-9fb2-fda2c6543644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024401CE1AE0>]}
[0m01:40:01.403476 [error] [MainThread]: Encountered an error:

[0m01:40:01.407509 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\musta\AppData\Local\Programs\Python\Python313\Lib\site-packages\dbt\cli\requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\musta\AppData\Local\Programs\Python\Python313\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\musta\AppData\Local\Programs\Python\Python313\Lib\site-packages\dbt\cli\requires.py", line 276, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\musta\AppData\Local\Programs\Python\Python313\Lib\site-packages\dbt\cli\requires.py", line 321, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\musta\AppData\Local\Programs\Python\Python313\Lib\site-packages\dbt\cli\requires.py", line 368, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\musta\AppData\Local\Programs\Python\Python313\Lib\site-packages\dbt\cli\main.py", line 307, in docs_serve
    results = task.run()
  File "C:\Users\musta\AppData\Local\Programs\Python\Python313\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
    ~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\musta\AppData\Local\Programs\Python\Python313\Lib\socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
  File "C:\Users\musta\AppData\Local\Programs\Python\Python313\Lib\selectors.py", line 314, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\musta\AppData\Local\Programs\Python\Python313\Lib\selectors.py", line 305, in _select
    r, w, x = select.select(r, w, w, timeout)
              ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m01:40:01.410465 [debug] [MainThread]: Command `dbt docs serve` failed at 01:40:01.410309 after 636.24 seconds
[0m01:40:01.410825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244029A9C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244029A9B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244029B0C80>]}
[0m01:40:01.411162 [debug] [MainThread]: Flushing usage events
[0m01:40:02.408150 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:40:17.731247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C80F771160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C810AE7ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C810AE7B10>]}


============================== 01:40:17.736459 | 14d05566-b655-4937-bc9e-daf5b196433f ==============================
[0m01:40:17.736459 [info ] [MainThread]: Running with dbt=1.11.4
[0m01:40:17.737273 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\musta\\ecommerce_pipeline\\logs'}
[0m01:40:38.745707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14d05566-b655-4937-bc9e-daf5b196433f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C80FDE1810>]}
[0m01:40:38.825628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14d05566-b655-4937-bc9e-daf5b196433f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C82DB95AE0>]}
[0m01:40:38.826774 [info ] [MainThread]: Registered adapter: bigquery=1.11.0
[0m01:40:39.558466 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m01:40:39.811779 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 4 files changed.
[0m01:40:39.812494 [debug] [MainThread]: Partial parsing: added file: ecommerce_pipeline://models\staging\sources.yml
[0m01:40:39.812988 [debug] [MainThread]: Partial parsing: updated file: ecommerce_pipeline://models\staging\stg_events.sql
[0m01:40:39.813499 [debug] [MainThread]: Partial parsing: updated file: ecommerce_pipeline://models\staging\stg_users.sql
[0m01:40:39.813986 [debug] [MainThread]: Partial parsing: updated file: ecommerce_pipeline://models\staging\stg_order_items.sql
[0m01:40:39.814490 [debug] [MainThread]: Partial parsing: updated file: ecommerce_pipeline://models\staging\stg_products.sql
[0m01:40:40.486050 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_pipeline.example
[0m01:40:40.499034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14d05566-b655-4937-bc9e-daf5b196433f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C82E3E7C50>]}
[0m01:40:40.638394 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\ecommerce_pipeline\target\manifest.json
[0m01:40:40.642282 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\ecommerce_pipeline\target\semantic_manifest.json
[0m01:40:40.678586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14d05566-b655-4937-bc9e-daf5b196433f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C82DB14D70>]}
[0m01:40:40.679184 [info ] [MainThread]: Found 12 models, 4 data tests, 5 sources, 538 macros
[0m01:40:40.679853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14d05566-b655-4937-bc9e-daf5b196433f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C82E7E7CB0>]}
[0m01:40:40.683105 [info ] [MainThread]: 
[0m01:40:40.683706 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:40:40.684242 [info ] [MainThread]: 
[0m01:40:40.684908 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:40:40.690827 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_portfolio-ecommerce-pipeline'
[0m01:40:40.691456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:42.054711 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_portfolio-ecommerce-pipeline_dbt_mos'
[0m01:40:42.055240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:40:43.368584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14d05566-b655-4937-bc9e-daf5b196433f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C82E80C6D0>]}
[0m01:40:43.369884 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:40:43.539910 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.stg_events
[0m01:40:43.541299 [info ] [Thread-1 (]: 1 of 12 START sql view model dbt_mos.stg_events ................................ [RUN]
[0m01:40:43.544363 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ecommerce_pipeline.stg_events'
[0m01:40:43.545846 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.stg_events
[0m01:40:43.566658 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.stg_events"
[0m01:40:43.569521 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.stg_events
[0m01:40:43.635302 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.stg_events"
[0m01:40:43.636431 [debug] [Thread-1 (]: On model.ecommerce_pipeline.stg_events: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.stg_events"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_events`
  OPTIONS()
  as with source as (
    select * from `bigquery-public-data`.`thelook_ecommerce`.`events`
)

select
    id as event_id,
    user_id,
    session_id,
    event_type,
    uri as page_url,
    created_at as event_time,
    traffic_source,
    browser
from source;


[0m01:40:43.636967 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:40:45.653953 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:261e36fa-0cd9-4300-b7db-d9ab052b784a&page=queryresults
[0m01:40:46.160065 [debug] [Thread-1 (]: SQL status: OK in 0.505 seconds
[0m01:40:46.277944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14d05566-b655-4937-bc9e-daf5b196433f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C82E991490>]}
[0m01:40:46.278735 [info ] [Thread-1 (]: 1 of 12 OK created sql view model dbt_mos.stg_events ........................... [[32mCREATE VIEW (0 processed)[0m in 2.73s]
[0m01:40:46.279919 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.stg_events
[0m01:40:46.280558 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.stg_order_items
[0m01:40:46.281196 [info ] [Thread-1 (]: 2 of 12 START sql view model dbt_mos.stg_order_items ........................... [RUN]
[0m01:40:46.281911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.stg_events, now model.ecommerce_pipeline.stg_order_items)
[0m01:40:46.282329 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.stg_order_items
[0m01:40:46.286715 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.stg_order_items"
[0m01:40:46.288514 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.stg_order_items
[0m01:40:46.293618 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.stg_order_items"
[0m01:40:46.294877 [debug] [Thread-1 (]: On model.ecommerce_pipeline.stg_order_items: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.stg_order_items"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_order_items`
  OPTIONS()
  as with source as (
    select * from `bigquery-public-data`.`thelook_ecommerce`.`order_items`
)

select
    id as order_item_id,
    order_id,
    user_id,
    product_id,
    sale_price,
    created_at as ordered_at,
    shipped_at,
    delivered_at,
    returned_at,
    status
from source;


[0m01:40:46.295503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:40:47.914853 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:b1d44634-26b1-4df0-b64b-d54c9c08ad99&page=queryresults
[0m01:40:48.409190 [debug] [Thread-1 (]: SQL status: OK in 0.494 seconds
[0m01:40:48.413514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14d05566-b655-4937-bc9e-daf5b196433f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C82E787AC0>]}
[0m01:40:48.414153 [info ] [Thread-1 (]: 2 of 12 OK created sql view model dbt_mos.stg_order_items ...................... [[32mCREATE VIEW (0 processed)[0m in 2.13s]
[0m01:40:48.415296 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.stg_order_items
[0m01:40:48.415750 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.stg_orders
[0m01:40:48.416138 [info ] [Thread-1 (]: 3 of 12 START sql view model dbt_mos.stg_orders ................................ [RUN]
[0m01:40:48.417078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.stg_order_items, now model.ecommerce_pipeline.stg_orders)
[0m01:40:48.417706 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.stg_orders
[0m01:40:48.419772 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.stg_orders"
[0m01:40:48.420844 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.stg_orders
[0m01:40:48.423799 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.stg_orders"
[0m01:40:48.424785 [debug] [Thread-1 (]: On model.ecommerce_pipeline.stg_orders: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.stg_orders"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_orders`
  OPTIONS()
  as with source as (
    select * from `bigquery-public-data.thelook_ecommerce.orders`
)

select
    order_id,
    user_id,
    status,
    created_at as order_date,
    num_of_item as item_count
from source;


[0m01:40:48.425637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:40:50.044379 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:8805d557-8195-4ccd-b517-bbaddbace167&page=queryresults
[0m01:40:50.578481 [debug] [Thread-1 (]: SQL status: OK in 0.534 seconds
[0m01:40:50.583546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14d05566-b655-4937-bc9e-daf5b196433f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C82EFAC050>]}
[0m01:40:50.584341 [info ] [Thread-1 (]: 3 of 12 OK created sql view model dbt_mos.stg_orders ........................... [[32mCREATE VIEW (0 processed)[0m in 2.17s]
[0m01:40:50.585393 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.stg_orders
[0m01:40:50.585839 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.stg_products
[0m01:40:50.586432 [info ] [Thread-1 (]: 4 of 12 START sql view model dbt_mos.stg_products .............................. [RUN]
[0m01:40:50.587810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.stg_orders, now model.ecommerce_pipeline.stg_products)
[0m01:40:50.588498 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.stg_products
[0m01:40:50.591457 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.stg_products"
[0m01:40:50.592491 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.stg_products
[0m01:40:50.596771 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.stg_products"
[0m01:40:50.597936 [debug] [Thread-1 (]: On model.ecommerce_pipeline.stg_products: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.stg_products"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_products`
  OPTIONS()
  as with source as (
    select * from `bigquery-public-data`.`thelook_ecommerce`.`products`
)

select
    id as product_id,
    name as product_name,
    category,
    brand,
    department,
    cost,
    retail_price
from source;


[0m01:40:50.598574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:40:52.741069 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:1d270111-ae73-48c3-9f03-e0a7918d1fc0&page=queryresults
[0m01:40:53.365436 [debug] [Thread-1 (]: SQL status: OK in 0.623 seconds
[0m01:40:53.371734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14d05566-b655-4937-bc9e-daf5b196433f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C82EFFA2D0>]}
[0m01:40:53.372669 [info ] [Thread-1 (]: 4 of 12 OK created sql view model dbt_mos.stg_products ......................... [[32mCREATE VIEW (0 processed)[0m in 2.78s]
[0m01:40:53.374060 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.stg_products
[0m01:40:53.374871 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.stg_users
[0m01:40:53.375813 [info ] [Thread-1 (]: 5 of 12 START sql view model dbt_mos.stg_users ................................. [RUN]
[0m01:40:53.376723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.stg_products, now model.ecommerce_pipeline.stg_users)
[0m01:40:53.377230 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.stg_users
[0m01:40:53.381120 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.stg_users"
[0m01:40:53.382773 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.stg_users
[0m01:40:53.387445 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.stg_users"
[0m01:40:53.388599 [debug] [Thread-1 (]: On model.ecommerce_pipeline.stg_users: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.stg_users"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_users`
  OPTIONS()
  as with source as (
    select * from `bigquery-public-data`.`thelook_ecommerce`.`users`
)

select
    id as user_id,
    first_name,
    last_name,
    email,
    country,
    created_at as signup_date
from source;


[0m01:40:53.389250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:40:55.271836 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:f5aba479-3a88-4c79-ace0-500c179bf483&page=queryresults
[0m01:40:55.791316 [debug] [Thread-1 (]: SQL status: OK in 0.519 seconds
[0m01:40:55.797129 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14d05566-b655-4937-bc9e-daf5b196433f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C82E778BB0>]}
[0m01:40:55.798372 [info ] [Thread-1 (]: 5 of 12 OK created sql view model dbt_mos.stg_users ............................ [[32mCREATE VIEW (0 processed)[0m in 2.42s]
[0m01:40:55.799782 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.stg_users
[0m01:40:55.800380 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.int_order_items_with_products
[0m01:40:55.801126 [info ] [Thread-1 (]: 6 of 12 START sql view model dbt_mos.int_order_items_with_products ............. [RUN]
[0m01:40:55.801911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.stg_users, now model.ecommerce_pipeline.int_order_items_with_products)
[0m01:40:55.802338 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.int_order_items_with_products
[0m01:40:55.806407 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.int_order_items_with_products"
[0m01:40:55.807418 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.int_order_items_with_products
[0m01:40:55.815853 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.int_order_items_with_products"
[0m01:40:55.817558 [debug] [Thread-1 (]: On model.ecommerce_pipeline.int_order_items_with_products: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.int_order_items_with_products"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`int_order_items_with_products`
  OPTIONS()
  as with order_items as (
    select * from `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_order_items`
),

products as (
    select * from `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_products`
)

select
    oi.order_item_id,
    oi.order_id,
    oi.user_id,
    oi.product_id,
    p.product_name,
    p.category,
    p.brand,
    p.department,
    p.cost,
    p.retail_price,
    oi.sale_price,
    oi.sale_price - p.cost as profit,
    oi.ordered_at,
    oi.shipped_at,
    oi.delivered_at,
    oi.returned_at,
    oi.status
from order_items oi
left join products p on oi.product_id = p.product_id;


[0m01:40:55.818503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:40:57.589336 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:0f965831-2d9f-4a10-a998-0bfb41ca78be&page=queryresults
[0m01:40:58.147221 [debug] [Thread-1 (]: SQL status: OK in 0.557 seconds
[0m01:40:58.155920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14d05566-b655-4937-bc9e-daf5b196433f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C82E69BA10>]}
[0m01:40:58.157416 [info ] [Thread-1 (]: 6 of 12 OK created sql view model dbt_mos.int_order_items_with_products ........ [[32mCREATE VIEW (0 processed)[0m in 2.35s]
[0m01:40:58.160901 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.int_order_items_with_products
[0m01:40:58.161877 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.int_customer_orders
[0m01:40:58.162815 [info ] [Thread-1 (]: 7 of 12 START sql view model dbt_mos.int_customer_orders ....................... [RUN]
[0m01:40:58.164234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.int_order_items_with_products, now model.ecommerce_pipeline.int_customer_orders)
[0m01:40:58.165589 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.int_customer_orders
[0m01:40:58.170029 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.int_customer_orders"
[0m01:40:58.171019 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.int_customer_orders
[0m01:40:58.176006 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.int_customer_orders"
[0m01:40:58.177636 [debug] [Thread-1 (]: On model.ecommerce_pipeline.int_customer_orders: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.int_customer_orders"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`int_customer_orders`
  OPTIONS()
  as with users as (
    select * from `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_users`
),

order_items as (
    select * from `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_order_items`
)

select
    u.user_id,
    u.first_name,
    u.last_name,
    u.country,
    u.signup_date,
    count(distinct oi.order_id) as total_orders,
    count(oi.order_item_id) as total_items,
    sum(oi.sale_price) as total_revenue,
    min(oi.ordered_at) as first_order_date,
    max(oi.ordered_at) as last_order_date
from users u
left join order_items oi on u.user_id = oi.user_id
group by 1, 2, 3, 4, 5;


[0m01:40:58.178597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:40:59.790690 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:68756019-841d-48f5-89a1-715e7599f894&page=queryresults
[0m01:41:00.303895 [debug] [Thread-1 (]: SQL status: OK in 0.512 seconds
[0m01:41:00.308380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14d05566-b655-4937-bc9e-daf5b196433f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C82EF440B0>]}
[0m01:41:00.309032 [info ] [Thread-1 (]: 7 of 12 OK created sql view model dbt_mos.int_customer_orders .................. [[32mCREATE VIEW (0 processed)[0m in 2.14s]
[0m01:41:00.310188 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.int_customer_orders
[0m01:41:00.310530 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.int_orders_with_users
[0m01:41:00.310915 [info ] [Thread-1 (]: 8 of 12 START sql view model dbt_mos.int_orders_with_users ..................... [RUN]
[0m01:41:00.311752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.int_customer_orders, now model.ecommerce_pipeline.int_orders_with_users)
[0m01:41:00.312067 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.int_orders_with_users
[0m01:41:00.316064 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.int_orders_with_users"
[0m01:41:00.317112 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.int_orders_with_users
[0m01:41:00.320076 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.int_orders_with_users"
[0m01:41:00.321206 [debug] [Thread-1 (]: On model.ecommerce_pipeline.int_orders_with_users: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.int_orders_with_users"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`int_orders_with_users`
  OPTIONS()
  as with orders as (
    select * from `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_orders`
),

users as (
    select * from `portfolio-ecommerce-pipeline`.`dbt_mos`.`stg_users`
)

select
    o.order_id,
    o.order_date,
    o.status,
    o.item_count,
    u.user_id,
    u.first_name,
    u.last_name,
    u.country
from orders o
left join users u on o.user_id = u.user_id;


[0m01:41:00.322166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:02.258432 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:6becb6ce-1fac-4dc6-9dd2-7b9f3d84344f&page=queryresults
[0m01:41:02.749712 [debug] [Thread-1 (]: SQL status: OK in 0.491 seconds
[0m01:41:02.754765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14d05566-b655-4937-bc9e-daf5b196433f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C82EF46AB0>]}
[0m01:41:02.755561 [info ] [Thread-1 (]: 8 of 12 OK created sql view model dbt_mos.int_orders_with_users ................ [[32mCREATE VIEW (0 processed)[0m in 2.44s]
[0m01:41:02.756791 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.int_orders_with_users
[0m01:41:02.757359 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.fct_monthly_revenue
[0m01:41:02.758146 [info ] [Thread-1 (]: 9 of 12 START sql view model dbt_mos.fct_monthly_revenue ....................... [RUN]
[0m01:41:02.759232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.int_orders_with_users, now model.ecommerce_pipeline.fct_monthly_revenue)
[0m01:41:02.759680 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.fct_monthly_revenue
[0m01:41:02.762637 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.fct_monthly_revenue"
[0m01:41:02.763802 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.fct_monthly_revenue
[0m01:41:02.769137 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.fct_monthly_revenue"
[0m01:41:02.770311 [debug] [Thread-1 (]: On model.ecommerce_pipeline.fct_monthly_revenue: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.fct_monthly_revenue"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`fct_monthly_revenue`
  OPTIONS()
  as with order_items as (
    select * from `portfolio-ecommerce-pipeline`.`dbt_mos`.`int_order_items_with_products`
)

select
    date_trunc(ordered_at, month) as month,
    category,
    department,
    count(distinct order_id) as total_orders,
    count(order_item_id) as total_items,
    sum(sale_price) as total_revenue,
    sum(profit) as total_profit,
    avg(sale_price) as avg_order_value
from order_items
where status != 'Cancelled'
group by 1, 2, 3;


[0m01:41:02.770932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:05.181862 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:97c6b548-bd86-4040-bc2f-4b8f65d8afc4&page=queryresults
[0m01:41:05.694146 [debug] [Thread-1 (]: SQL status: OK in 0.512 seconds
[0m01:41:05.700410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14d05566-b655-4937-bc9e-daf5b196433f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C82EF465D0>]}
[0m01:41:05.701317 [info ] [Thread-1 (]: 9 of 12 OK created sql view model dbt_mos.fct_monthly_revenue .................. [[32mCREATE VIEW (0 processed)[0m in 2.94s]
[0m01:41:05.702606 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.fct_monthly_revenue
[0m01:41:05.703182 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.fct_product_performance
[0m01:41:05.703857 [info ] [Thread-1 (]: 10 of 12 START sql view model dbt_mos.fct_product_performance .................. [RUN]
[0m01:41:05.704954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.fct_monthly_revenue, now model.ecommerce_pipeline.fct_product_performance)
[0m01:41:05.705773 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.fct_product_performance
[0m01:41:05.710903 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.fct_product_performance"
[0m01:41:05.712387 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.fct_product_performance
[0m01:41:05.718216 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.fct_product_performance"
[0m01:41:05.719741 [debug] [Thread-1 (]: On model.ecommerce_pipeline.fct_product_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.fct_product_performance"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`fct_product_performance`
  OPTIONS()
  as with order_items as (
    select * from `portfolio-ecommerce-pipeline`.`dbt_mos`.`int_order_items_with_products`
)

select
    product_id,
    product_name,
    category,
    brand,
    department,
    count(distinct order_id) as times_ordered,
    sum(sale_price) as total_revenue,
    sum(profit) as total_profit,
    avg(sale_price) as avg_sale_price,
    sum(case when status = 'Returned' then 1 else 0 end) as return_count
from order_items
group by 1, 2, 3, 4, 5;


[0m01:41:05.720455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:07.554715 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:fd98552b-9e47-4290-877f-5decc69ba099&page=queryresults
[0m01:41:08.131753 [debug] [Thread-1 (]: SQL status: OK in 0.576 seconds
[0m01:41:08.135481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14d05566-b655-4937-bc9e-daf5b196433f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C82EF47EF0>]}
[0m01:41:08.136077 [info ] [Thread-1 (]: 10 of 12 OK created sql view model dbt_mos.fct_product_performance ............. [[32mCREATE VIEW (0 processed)[0m in 2.43s]
[0m01:41:08.137160 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.fct_product_performance
[0m01:41:08.137547 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.fct_customer_lifetime_value
[0m01:41:08.137939 [info ] [Thread-1 (]: 11 of 12 START sql view model dbt_mos.fct_customer_lifetime_value .............. [RUN]
[0m01:41:08.138629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.fct_product_performance, now model.ecommerce_pipeline.fct_customer_lifetime_value)
[0m01:41:08.138945 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.fct_customer_lifetime_value
[0m01:41:08.141218 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.fct_customer_lifetime_value"
[0m01:41:08.142147 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.fct_customer_lifetime_value
[0m01:41:08.145138 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.fct_customer_lifetime_value"
[0m01:41:08.146197 [debug] [Thread-1 (]: On model.ecommerce_pipeline.fct_customer_lifetime_value: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.fct_customer_lifetime_value"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`fct_customer_lifetime_value`
  OPTIONS()
  as with customer_orders as (
    select * from `portfolio-ecommerce-pipeline`.`dbt_mos`.`int_customer_orders`
)

select
    user_id,
    first_name,
    last_name,
    country,
    signup_date,
    total_orders,
    total_items,
    total_revenue,
    first_order_date,
    last_order_date,
    date_diff(last_order_date, first_order_date, day) as customer_lifespan_days,
    case
        when total_revenue >= 500 then 'High Value'
        when total_revenue >= 100 then 'Medium Value'
        else 'Low Value'
    end as customer_segment
from customer_orders
where total_orders > 0;


[0m01:41:08.146719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:09.746124 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:5f3ebec1-c322-41ef-af16-dc1f4b4a24fe&page=queryresults
[0m01:41:10.213686 [debug] [Thread-1 (]: SQL status: OK in 0.467 seconds
[0m01:41:10.217402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14d05566-b655-4937-bc9e-daf5b196433f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C82F095070>]}
[0m01:41:10.217940 [info ] [Thread-1 (]: 11 of 12 OK created sql view model dbt_mos.fct_customer_lifetime_value ......... [[32mCREATE VIEW (0 processed)[0m in 2.08s]
[0m01:41:10.219107 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.fct_customer_lifetime_value
[0m01:41:10.219722 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.fct_daily_sales
[0m01:41:10.220226 [info ] [Thread-1 (]: 12 of 12 START sql view model dbt_mos.fct_daily_sales .......................... [RUN]
[0m01:41:10.220975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.fct_customer_lifetime_value, now model.ecommerce_pipeline.fct_daily_sales)
[0m01:41:10.221386 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.fct_daily_sales
[0m01:41:10.223846 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.fct_daily_sales"
[0m01:41:10.224796 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.fct_daily_sales
[0m01:41:10.227670 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_pipeline.fct_daily_sales"
[0m01:41:10.228628 [debug] [Thread-1 (]: On model.ecommerce_pipeline.fct_daily_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "node_id": "model.ecommerce_pipeline.fct_daily_sales"} */


  create or replace view `portfolio-ecommerce-pipeline`.`dbt_mos`.`fct_daily_sales`
  OPTIONS()
  as with orders as (
    select * from `portfolio-ecommerce-pipeline`.`dbt_mos`.`int_orders_with_users`
)

select
    date(order_date) as sale_date,
    country,
    count(distinct order_id) as total_orders,
    count(distinct user_id) as unique_customers,
    sum(item_count) as total_items_sold
from orders
where status = 'Complete'
group by 1, 2;


[0m01:41:10.229098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:11.863158 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:997666cb-9a0e-4205-a020-b1deb03cda48&page=queryresults
[0m01:41:12.587156 [debug] [Thread-1 (]: SQL status: OK in 0.724 seconds
[0m01:41:12.591002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14d05566-b655-4937-bc9e-daf5b196433f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C82F094AD0>]}
[0m01:41:12.591515 [info ] [Thread-1 (]: 12 of 12 OK created sql view model dbt_mos.fct_daily_sales ..................... [[32mCREATE VIEW (0 processed)[0m in 2.37s]
[0m01:41:12.592608 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.fct_daily_sales
[0m01:41:12.594166 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:41:12.633250 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:41:12.633567 [debug] [MainThread]: Connection 'list_portfolio-ecommerce-pipeline' was properly closed.
[0m01:41:12.633804 [debug] [MainThread]: Connection 'list_portfolio-ecommerce-pipeline_dbt_mos' was properly closed.
[0m01:41:12.634084 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.fct_daily_sales' was properly closed.
[0m01:41:12.634546 [info ] [MainThread]: 
[0m01:41:12.635245 [info ] [MainThread]: Finished running 12 view models in 0 hours 0 minutes and 31.95 seconds (31.95s).
[0m01:41:12.638489 [debug] [MainThread]: Command end result
[0m01:41:12.665529 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\ecommerce_pipeline\target\manifest.json
[0m01:41:12.669352 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\ecommerce_pipeline\target\semantic_manifest.json
[0m01:41:12.679405 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\musta\ecommerce_pipeline\target\run_results.json
[0m01:41:12.679797 [info ] [MainThread]: 
[0m01:41:12.680526 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:41:12.681124 [info ] [MainThread]: 
[0m01:41:12.682631 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=12
[0m01:41:12.684469 [debug] [MainThread]: Command `dbt run` succeeded at 01:41:12.684239 after 55.11 seconds
[0m01:41:12.684919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C82EF45BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C82F0CBA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C82F0CB9B0>]}
[0m01:41:12.685342 [debug] [MainThread]: Flushing usage events
[0m01:41:13.878229 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:41:16.995192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F82F71160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F842E7ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F842E7B10>]}


============================== 01:41:17.000446 | 89c231ce-9d18-4f16-9de3-dfaaff5aa49a ==============================
[0m01:41:17.000446 [info ] [MainThread]: Running with dbt=1.11.4
[0m01:41:17.001269 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt docs generate', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\musta\\ecommerce_pipeline\\logs'}
[0m01:41:32.021181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89c231ce-9d18-4f16-9de3-dfaaff5aa49a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F835F1810>]}
[0m01:41:32.089804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89c231ce-9d18-4f16-9de3-dfaaff5aa49a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FA1341AE0>]}
[0m01:41:32.090456 [info ] [MainThread]: Registered adapter: bigquery=1.11.0
[0m01:41:32.699415 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m01:41:32.884509 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:41:32.885010 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m01:41:32.885407 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:41:32.903993 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.ecommerce_pipeline.example
[0m01:41:32.961283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89c231ce-9d18-4f16-9de3-dfaaff5aa49a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FA1316B50>]}
[0m01:41:32.993893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89c231ce-9d18-4f16-9de3-dfaaff5aa49a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FA1CE07D0>]}
[0m01:41:32.994500 [info ] [MainThread]: Found 12 models, 4 data tests, 5 sources, 538 macros
[0m01:41:32.995202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89c231ce-9d18-4f16-9de3-dfaaff5aa49a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FA1BCECF0>]}
[0m01:41:32.997724 [info ] [MainThread]: 
[0m01:41:32.998276 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:41:32.998808 [info ] [MainThread]: 
[0m01:41:32.999626 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:41:33.005516 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_portfolio-ecommerce-pipeline_dbt_mos'
[0m01:41:33.006085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:41:34.308412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89c231ce-9d18-4f16-9de3-dfaaff5aa49a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FA1DC0460>]}
[0m01:41:34.308853 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:41:34.347397 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.stg_events
[0m01:41:34.347897 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.ecommerce_pipeline.stg_events'
[0m01:41:34.348241 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.stg_events
[0m01:41:34.356541 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.stg_events"
[0m01:41:34.357489 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.stg_events
[0m01:41:34.358111 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:41:34.392189 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.stg_events
[0m01:41:34.392596 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.stg_order_items
[0m01:41:34.393082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.stg_events, now model.ecommerce_pipeline.stg_order_items)
[0m01:41:34.393385 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.stg_order_items
[0m01:41:34.395741 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.stg_order_items"
[0m01:41:34.396582 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.stg_order_items
[0m01:41:34.397102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:34.442445 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.stg_order_items
[0m01:41:34.442867 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.stg_orders
[0m01:41:34.443317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.stg_order_items, now model.ecommerce_pipeline.stg_orders)
[0m01:41:34.443723 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.stg_orders
[0m01:41:34.445821 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.stg_orders"
[0m01:41:34.446626 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.stg_orders
[0m01:41:34.447176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:34.483689 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.stg_orders
[0m01:41:34.484060 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.stg_products
[0m01:41:34.484375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.stg_orders, now model.ecommerce_pipeline.stg_products)
[0m01:41:34.485057 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.stg_products
[0m01:41:34.487242 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.stg_products"
[0m01:41:34.488184 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.stg_products
[0m01:41:34.488807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:34.523251 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.stg_products
[0m01:41:34.523723 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.stg_users
[0m01:41:34.524479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.stg_products, now model.ecommerce_pipeline.stg_users)
[0m01:41:34.525172 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.stg_users
[0m01:41:34.528092 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.stg_users"
[0m01:41:34.529165 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.stg_users
[0m01:41:34.529628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:34.563812 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.stg_users
[0m01:41:34.564354 [debug] [Thread-1 (]: Began running node test.ecommerce_pipeline.not_null_stg_orders_order_id.81cfe2fe64
[0m01:41:34.564861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.stg_users, now test.ecommerce_pipeline.not_null_stg_orders_order_id.81cfe2fe64)
[0m01:41:34.565392 [debug] [Thread-1 (]: Began compiling node test.ecommerce_pipeline.not_null_stg_orders_order_id.81cfe2fe64
[0m01:41:34.578327 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_pipeline.not_null_stg_orders_order_id.81cfe2fe64"
[0m01:41:34.579378 [debug] [Thread-1 (]: Began executing node test.ecommerce_pipeline.not_null_stg_orders_order_id.81cfe2fe64
[0m01:41:34.579861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:34.614286 [debug] [Thread-1 (]: Finished running node test.ecommerce_pipeline.not_null_stg_orders_order_id.81cfe2fe64
[0m01:41:34.614671 [debug] [Thread-1 (]: Began running node test.ecommerce_pipeline.unique_stg_orders_order_id.e3b841c71a
[0m01:41:34.615066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_pipeline.not_null_stg_orders_order_id.81cfe2fe64, now test.ecommerce_pipeline.unique_stg_orders_order_id.e3b841c71a)
[0m01:41:34.615382 [debug] [Thread-1 (]: Began compiling node test.ecommerce_pipeline.unique_stg_orders_order_id.e3b841c71a
[0m01:41:34.621150 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_pipeline.unique_stg_orders_order_id.e3b841c71a"
[0m01:41:34.622002 [debug] [Thread-1 (]: Began executing node test.ecommerce_pipeline.unique_stg_orders_order_id.e3b841c71a
[0m01:41:34.622483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:34.659738 [debug] [Thread-1 (]: Finished running node test.ecommerce_pipeline.unique_stg_orders_order_id.e3b841c71a
[0m01:41:34.661696 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.int_order_items_with_products
[0m01:41:34.663146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_pipeline.unique_stg_orders_order_id.e3b841c71a, now model.ecommerce_pipeline.int_order_items_with_products)
[0m01:41:34.664223 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.int_order_items_with_products
[0m01:41:34.670252 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.int_order_items_with_products"
[0m01:41:34.671194 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.int_order_items_with_products
[0m01:41:34.671731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:34.710341 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.int_order_items_with_products
[0m01:41:34.710714 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.int_customer_orders
[0m01:41:34.711030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.int_order_items_with_products, now model.ecommerce_pipeline.int_customer_orders)
[0m01:41:34.711705 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.int_customer_orders
[0m01:41:34.717952 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.int_customer_orders"
[0m01:41:34.719142 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.int_customer_orders
[0m01:41:34.719634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:34.754648 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.int_customer_orders
[0m01:41:34.755058 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.int_orders_with_users
[0m01:41:34.755625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.int_customer_orders, now model.ecommerce_pipeline.int_orders_with_users)
[0m01:41:34.756105 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.int_orders_with_users
[0m01:41:34.758584 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.int_orders_with_users"
[0m01:41:34.759522 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.int_orders_with_users
[0m01:41:34.760001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:34.795561 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.int_orders_with_users
[0m01:41:34.796062 [debug] [Thread-1 (]: Began running node test.ecommerce_pipeline.not_null_stg_users_user_id.980dfc1b77
[0m01:41:34.796634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.int_orders_with_users, now test.ecommerce_pipeline.not_null_stg_users_user_id.980dfc1b77)
[0m01:41:34.797020 [debug] [Thread-1 (]: Began compiling node test.ecommerce_pipeline.not_null_stg_users_user_id.980dfc1b77
[0m01:41:34.800484 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_pipeline.not_null_stg_users_user_id.980dfc1b77"
[0m01:41:34.801327 [debug] [Thread-1 (]: Began executing node test.ecommerce_pipeline.not_null_stg_users_user_id.980dfc1b77
[0m01:41:34.801786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:34.838463 [debug] [Thread-1 (]: Finished running node test.ecommerce_pipeline.not_null_stg_users_user_id.980dfc1b77
[0m01:41:34.838938 [debug] [Thread-1 (]: Began running node test.ecommerce_pipeline.unique_stg_users_user_id.c2ff477e6b
[0m01:41:34.839430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_pipeline.not_null_stg_users_user_id.980dfc1b77, now test.ecommerce_pipeline.unique_stg_users_user_id.c2ff477e6b)
[0m01:41:34.839856 [debug] [Thread-1 (]: Began compiling node test.ecommerce_pipeline.unique_stg_users_user_id.c2ff477e6b
[0m01:41:34.843002 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_pipeline.unique_stg_users_user_id.c2ff477e6b"
[0m01:41:34.843909 [debug] [Thread-1 (]: Began executing node test.ecommerce_pipeline.unique_stg_users_user_id.c2ff477e6b
[0m01:41:34.844520 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:34.878517 [debug] [Thread-1 (]: Finished running node test.ecommerce_pipeline.unique_stg_users_user_id.c2ff477e6b
[0m01:41:34.878923 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.fct_monthly_revenue
[0m01:41:34.879360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.ecommerce_pipeline.unique_stg_users_user_id.c2ff477e6b, now model.ecommerce_pipeline.fct_monthly_revenue)
[0m01:41:34.879667 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.fct_monthly_revenue
[0m01:41:34.881822 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.fct_monthly_revenue"
[0m01:41:34.882693 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.fct_monthly_revenue
[0m01:41:34.883327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:34.926179 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.fct_monthly_revenue
[0m01:41:34.927406 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.fct_product_performance
[0m01:41:34.928572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.fct_monthly_revenue, now model.ecommerce_pipeline.fct_product_performance)
[0m01:41:34.929178 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.fct_product_performance
[0m01:41:34.935910 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.fct_product_performance"
[0m01:41:34.936790 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.fct_product_performance
[0m01:41:34.937295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:34.977154 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.fct_product_performance
[0m01:41:34.977775 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.fct_customer_lifetime_value
[0m01:41:34.978350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.fct_product_performance, now model.ecommerce_pipeline.fct_customer_lifetime_value)
[0m01:41:34.978829 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.fct_customer_lifetime_value
[0m01:41:34.981543 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.fct_customer_lifetime_value"
[0m01:41:34.982497 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.fct_customer_lifetime_value
[0m01:41:34.983005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:35.028113 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.fct_customer_lifetime_value
[0m01:41:35.028655 [debug] [Thread-1 (]: Began running node model.ecommerce_pipeline.fct_daily_sales
[0m01:41:35.029201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.ecommerce_pipeline.fct_customer_lifetime_value, now model.ecommerce_pipeline.fct_daily_sales)
[0m01:41:35.029687 [debug] [Thread-1 (]: Began compiling node model.ecommerce_pipeline.fct_daily_sales
[0m01:41:35.033335 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_pipeline.fct_daily_sales"
[0m01:41:35.034405 [debug] [Thread-1 (]: Began executing node model.ecommerce_pipeline.fct_daily_sales
[0m01:41:35.034967 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:35.078307 [debug] [Thread-1 (]: Finished running node model.ecommerce_pipeline.fct_daily_sales
[0m01:41:35.079800 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:41:35.080081 [debug] [MainThread]: Connection 'list_portfolio-ecommerce-pipeline_dbt_mos' was properly closed.
[0m01:41:35.080405 [debug] [MainThread]: Connection 'model.ecommerce_pipeline.fct_daily_sales' was properly closed.
[0m01:41:35.083297 [debug] [MainThread]: Command end result
[0m01:41:35.196395 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\ecommerce_pipeline\target\manifest.json
[0m01:41:35.199288 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\ecommerce_pipeline\target\semantic_manifest.json
[0m01:41:35.207208 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\musta\ecommerce_pipeline\target\run_results.json
[0m01:41:35.209854 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m01:41:35.210204 [info ] [MainThread]: Building catalog
[0m01:41:35.217932 [debug] [ThreadPool]: Acquiring new bigquery connection 'bigquery-public-data.information_schema'
[0m01:41:35.240860 [debug] [ThreadPool]: On bigquery-public-data.information_schema: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "bigquery-public-data.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `bigquery-public-data`.`thelook_ecommerce`.__TABLES__ tables
    left join `bigquery-public-data`.`thelook_ecommerce`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `bigquery-public-data`.`thelook_ecommerce`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('thelook_ecommerce')
                            and upper(table_name) = upper('orders')
                            ) or (
                                upper(table_schema) = upper('thelook_ecommerce')
                            and upper(table_name) = upper('products')
                            ) or (
                                upper(table_schema) = upper('thelook_ecommerce')
                            and upper(table_name) = upper('events')
                            ) or (
                                upper(table_schema) = upper('thelook_ecommerce')
                            and upper(table_name) = upper('users')
                            ) or (
                                upper(table_schema) = upper('thelook_ecommerce')
                            and upper(table_name) = upper('order_items')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `bigquery-public-data`.`thelook_ecommerce`.INFORMATION_SCHEMA.COLUMNS columns
    join `bigquery-public-data`.`thelook_ecommerce`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m01:41:35.242039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:41:36.702166 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:dc85f2db-31bb-4f91-b9f2-62fb55258121&page=queryresults
[0m01:41:37.726122 [debug] [ThreadPool]: SQL status: OK in 1.023 seconds
[0m01:41:38.306074 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly bigquery-public-data.information_schema, now portfolio-ecommerce-pipeline.information_schema)
[0m01:41:38.308456 [debug] [ThreadPool]: On portfolio-ecommerce-pipeline.information_schema: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_pipeline", "target_name": "dev", "connection_name": "portfolio-ecommerce-pipeline.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `portfolio-ecommerce-pipeline`.`dbt_mos`.__TABLES__ tables
    left join `portfolio-ecommerce-pipeline`.`dbt_mos`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `portfolio-ecommerce-pipeline`.`dbt_mos`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('dbt_mos')
                            and upper(table_name) = upper('fct_monthly_revenue')
                            ) or (
                                upper(table_schema) = upper('dbt_mos')
                            and upper(table_name) = upper('stg_orders')
                            ) or (
                                upper(table_schema) = upper('dbt_mos')
                            and upper(table_name) = upper('int_customer_orders')
                            ) or (
                                upper(table_schema) = upper('dbt_mos')
                            and upper(table_name) = upper('fct_customer_lifetime_value')
                            ) or (
                                upper(table_schema) = upper('dbt_mos')
                            and upper(table_name) = upper('stg_order_items')
                            ) or (
                                upper(table_schema) = upper('dbt_mos')
                            and upper(table_name) = upper('fct_product_performance')
                            ) or (
                                upper(table_schema) = upper('dbt_mos')
                            and upper(table_name) = upper('stg_events')
                            ) or (
                                upper(table_schema) = upper('dbt_mos')
                            and upper(table_name) = upper('stg_users')
                            ) or (
                                upper(table_schema) = upper('dbt_mos')
                            and upper(table_name) = upper('int_orders_with_users')
                            ) or (
                                upper(table_schema) = upper('dbt_mos')
                            and upper(table_name) = upper('int_order_items_with_products')
                            ) or (
                                upper(table_schema) = upper('dbt_mos')
                            and upper(table_name) = upper('stg_products')
                            ) or (
                                upper(table_schema) = upper('dbt_mos')
                            and upper(table_name) = upper('fct_daily_sales')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `portfolio-ecommerce-pipeline`.`dbt_mos`.INFORMATION_SCHEMA.COLUMNS columns
    join `portfolio-ecommerce-pipeline`.`dbt_mos`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m01:41:38.309103 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:41:39.869881 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=portfolio-ecommerce-pipeline&j=bq:US:bb7ed109-1299-42a1-a26a-ae681b0b6d68&page=queryresults
[0m01:41:40.926019 [debug] [ThreadPool]: SQL status: OK in 1.056 seconds
[0m01:41:41.641447 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:41:41.691067 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\musta\ecommerce_pipeline\target\catalog.json
[0m01:41:41.719234 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\musta\ecommerce_pipeline\target\manifest.json
[0m01:41:41.721654 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\musta\ecommerce_pipeline\target\semantic_manifest.json
[0m01:41:41.722055 [info ] [MainThread]: Catalog written to C:\Users\musta\ecommerce_pipeline\target\catalog.json
[0m01:41:41.723437 [debug] [MainThread]: Command `dbt docs generate` succeeded at 01:41:41.723328 after 24.85 seconds
[0m01:41:41.723739 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m01:41:41.723980 [debug] [MainThread]: Connection 'portfolio-ecommerce-pipeline.information_schema' was properly closed.
[0m01:41:41.724251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013F840C6C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FA21EDB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FA21EDBD0>]}
[0m01:41:41.724548 [debug] [MainThread]: Flushing usage events
[0m01:41:42.586816 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:41:49.367233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F46F321160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F47069BED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F47069BB10>]}


============================== 01:41:49.371821 | 31de1183-ba33-4ba3-876d-004e3f08a7a7 ==============================
[0m01:41:49.371821 [info ] [MainThread]: Running with dbt=1.11.4
[0m01:41:49.372923 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\musta\\.dbt', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt docs serve', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\musta\\ecommerce_pipeline\\logs'}
[0m01:42:04.628430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31de1183-ba33-4ba3-876d-004e3f08a7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F46F9A1810>]}
[0m01:42:04.697733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31de1183-ba33-4ba3-876d-004e3f08a7a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F40DFE1AE0>]}
